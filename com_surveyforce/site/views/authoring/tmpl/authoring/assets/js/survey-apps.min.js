var $=jQuery,currQuestion,fileInterval=null,file={},firstSave=!1,BULKS=[{type:"vertical",values:[{fr:"Under 18",en:"Under 18"},{fr:"18-24",en:"18-24"},{fr:"25-34",en:"25-34"},{fr:"35-44",en:"35-44"},{fr:"45-54",en:"45-54"},{fr:"55-64",en:"55-64"},{fr:"65 or Above",en:"65 or Above"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Age"},{type:"vertical",values:[{fr:"Employed Full-Time",en:"Employed Full-Time"},{fr:"Employed Part-Time",en:"Employed Part-Time"},{fr:"Self-employed",en:"Self-employed"},{fr:"Not employed, but looking for work",en:"Not employed, but looking for work"},{fr:"Not employed and not looking for work",en:"Not employed and not looking for work"},{fr:"Homemaker",en:"Homemaker"},{fr:"Retired",en:"Retired"},{fr:"Student",en:"Student"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Employment"},{type:"vertical",values:[{fr:"Under $20,000",en:"Under $20,000"},{fr:"$20,000 - $30,000",en:"$20,000 - $30,000"},{fr:"$30,000 - $40,000",en:"$30,000 - $40,000"},{fr:"$40,000 - $50,000",en:"$40,000 - $50,000"},{fr:"$50,000 - $75,000",en:"$50,000 - $75,000"},{fr:"$75,000 - $100,000",en:"$75,000 - $100,000"},{fr:"$100,000 - $150,000",en:"$100,000 - $150,000"},{fr:"$150,000 or more",en:"$150,000 or more"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Income Level"},{type:"horizontal",values:[{fr:"Some High School",en:"Some High School"},{fr:"High School Graduate or Equivalent",en:"High School Graduate or Equivalent"},{fr:"Trade or Vocational Degree",en:"Trade or Vocational Degree"},{fr:"Some College",en:"Some College"},{fr:"Associate Degree",en:"Associate Degree"},{fr:"Bachelor's Degree",en:"Bachelor's Degree"},{fr:"Graduate of Professional Degree",en:"Graduate of Professional Degree"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Education"},{type:"vertical",values:[{fr:"Single, Never Married",en:"Single, Never Married"},{fr:"Married",en:"Married"},{fr:"Living with Partner",en:"Living with Partner"},{fr:"Separated",en:"Separated"},{fr:"Divorced",en:"Divorced"},{fr:"Widowed",en:"Widowed"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Marital Status"},{type:"vertical",values:[{fr:"White / Caucasian",en:"White / Caucasian"},{fr:"Spanish / Hispanic / Latino",en:"Spanish / Hispanic / Latino"},{fr:"Black / African American",en:"Black / African American"},{fr:"Asian",en:"Asian"},{fr:"Pacific Islander",en:"Pacific Islander"},{fr:"Native American",en:"Native American"},{fr:"Other",en:"Other"},{fr:"Prefer Not to Answer",en:"Prefer Not to Answer"}],name:"Race"},{type:"vertical",values:[{fr:"janvier",en:"January"},{fr:"février",en:"February"},{fr:"mars",en:"March"},{fr:"avril",en:"April"},{fr:"mai",en:"May"},{fr:"juin",en:"June"},{fr:"juillet",en:"July"},{fr:"août",en:"August"},{fr:"septembre",en:"September"},{fr:"octobre",en:"October"},{fr:"novembre",en:"November"},{fr:"décembre",en:"December"}],name:"Months"},{type:"vertical",values:[{fr:"lundi",en:"Monday"},{fr:"mardi",en:"Tuesday"},{fr:"mercredi",en:"Wednesday"},{fr:"jeudi",en:"Thursday"},{fr:"vendredi",en:"Friday"},{fr:"samedi",en:"Saturday"},{fr:"dimanche",en:"Sunday"}],name:"Days"},{type:"vertical",values:[{fr:"Alberta",en:"Alberta"},{fr:"Colombie-Britannique",en:"British Columbia"},{fr:"Manitoba",en:"Manitoba"},{fr:"Nouveau-Brunswick",en:"New Brunswick"},{fr:"Terre-Neuve-et-Labrador",en:"Newfoundland and Labrador"},{fr:"Territoires du Nord-Ouest",en:"Northwest Territories"},{fr:"Nouvelle-Écosse",en:"Nova Scotia"},{fr:"Nunavut",en:"Nunavut"},{fr:"Ontario",en:"Ontario"},{fr:"l'île du Prince-Édouard",en:"Prince Edward Island"},{fr:"Québec",en:"Quebec"},{fr:"Saskatchewan",en:"Saskatchewan"},{fr:"Yukon",en:"Yukon"}],name:"Canadian Provinces"},{type:"vertical",values:[{fr:"Alabama",en:"Alabama"},{fr:"Alaska",en:"Alaska"},{fr:"Arizona",en:"Arizona"},{fr:"Arkansas",en:"Arkansas"},{fr:"Californie",en:"California"},{fr:"Colorado",en:"Colorado"},{fr:"Connecticut",en:"Connecticut"},{fr:"Delaware",en:"Delaware"},{fr:"Floride",en:"Florida"},{fr:"Géorgie",en:"Georgia"},{fr:"Hawaï",en:"Hawaii"},{fr:"Idaho",en:"Idaho"},{fr:"Illinois",en:"Illinois"},{fr:"Indiana",en:"Indiana"},{fr:"Iowa",en:"Iowa"},{fr:"Kansas",en:"Kansas"},{fr:"Kentucky",en:"Kentucky"},{fr:"Louisiane",en:"Louisiana"},{fr:"Maine",en:"Maine"},{fr:"Mariland",en:"Maryland"},{fr:"Massachusetts",en:"Massachusetts"},{fr:"Michigan",en:"Michigan"},{fr:"Minnesota",en:"Minnesota"},{fr:"Mississippi",en:"Mississippi"},{fr:"Missouri",en:"Missouri"},{fr:"Montana",en:"Montana"},{fr:"Nebraska",en:"Nebraska"},{fr:"Nevada",en:"Nevada"},{fr:"New Hampshire",en:"New Hampshire"},{fr:"New Jersey",en:"New Jersey"},{fr:"Nouveau-Mexique",en:"New Mexico"},{fr:"New-York",en:"New York"},{fr:"Caroline du Nord",en:"North Carolina"},{fr:"Dakota du Nord",en:"North Dakota"},{fr:"Ohio",en:"Ohio"},{fr:"Oklahoma",en:"Oklahoma"},{fr:"Oregon",en:"Oregon"},{fr:"Pennsylvanie",en:"Pennsylvania"},{fr:"Rhode Island",en:"Rhode Island"},{fr:"Caroline du Sud",en:"South Carolina"},{fr:"Dakota du Sud",en:"South Dakota"},{fr:"Tennessee",en:"Tennessee"},{fr:"Texas",en:"Texas"},{fr:"Utah",en:"Utah"},{fr:"Vermont",en:"Vermont"},{fr:"Virginie",en:"Virginia"},{fr:"Washington",en:"Washington"},{fr:"Virginie Occidentale",en:"West Virginia"},{fr:"Wisconsin",en:"Wisconsin"},{fr:"Wyoming",en:"Wyoming"}],name:"US States"},{type:"vertical",values:[{fr:"Afghanistan",en:"Afghanistan"},{fr:"Albanie",en:"Albania"},{fr:"Algérie",en:"Algeria"},{fr:"Andorre",en:"Andorra"},{fr:"Angola",en:"Angola"},{fr:"Antarctique",en:"Antarctica"},{fr:"Antigua and Barbuda",en:"Antigua and Barbuda"},{fr:"Argentine",en:"Argentina"},{fr:"Arménie",en:"Armenia"},{fr:"Australie",en:"Australia"},{fr:"Autriche",en:"Austria"},{fr:"Azerbaïdjan",en:"Azerbaijan"},{fr:"Bahamas",en:"Bahamas"},{fr:"Bahreïn",en:"Bahrain"},{fr:"Bangladesh",en:"Bangladesh"},{fr:"La Barbade",en:"Barbados"},{fr:"Biélorussie",en:"Belarus"},{fr:"Belgique",en:"Belgium"},{fr:"Bélize",en:"Belize"},{fr:"Bénin",en:"Benin"},{fr:"Bermudes",en:"Bermuda"},{fr:"Boutan",en:"Bhutan"},{fr:"Bolivie",en:"Bolivia"},{fr:"Bosnie-Herzégovine",en:"Bosnia and Herzegovina"},{fr:"Botswana",en:"Botswana"},{fr:"Brésil",en:"Brazil"},{fr:"Brunei",en:"Brunei"},{fr:"Bulgarie",en:"Bulgaria"},{fr:"Burkina Faso",en:"Burkina Faso"},{fr:"Burma",en:"Burma"},{fr:"Burundi",en:"Burundi"},{fr:"Cambodge",en:"Cambodia"},{fr:"Cameroun",en:"Cameroon"},{fr:"Canada",en:"Canada"},{fr:"Cap-Vert",en:"Cape Verde"},{fr:"République Centrafricaine",en:"Central African Republic"},{fr:"Tchad",en:"Chad"},{fr:"Chili",en:"Chile"},{fr:"Chine",en:"China"},{fr:"Colombie",en:"Colombia"},{fr:"Comores",en:"Comoros"},{fr:"Congo, Democratic Republic",en:"Congo, Democratic Republic"},{fr:"Congo, Republic of the",en:"Congo, Republic of the"},{fr:"Costa Rica",en:"Costa Rica"},{fr:"Cote d'Ivoire",en:"Cote d'Ivoire"},{fr:"Croatie",en:"Croatia"},{fr:"Cuba",en:"Cuba"},{fr:"Chypre",en:"Cyprus"},{fr:"République tchèque",en:"Czech Republic"},{fr:"Danemark",en:"Denmark"},{fr:"Djibouti",en:"Djibouti"},{fr:"Dominique",en:"Dominica"},{fr:"République Dominicaine",en:"Dominican Republic"},{fr:"Timor Oriental",en:"East Timor"},{fr:"Équateur",en:"Ecuador"},{fr:"Égypte",en:"Egypt"},{fr:"Salvador",en:"El Salvador"},{fr:"Guinée Équatoriale",en:"Equatorial Guinea"},{fr:"Érythrée",en:"Eritrea"},{fr:"Estonie",en:"Estonia"},{fr:"Ethiopie",en:"Ethiopia"},{fr:"Fidji",en:"Fiji"},{fr:"Finlande",en:"Finland"},{fr:"France",en:"France"},{fr:"Gabon",en:"Gabon"},{fr:"Gambie",en:"Gambia"},{fr:"Géorgie",en:"Georgia"},{fr:"Allemagne",en:"Germany"},{fr:"Ghana",en:"Ghana"},{fr:"Grèce",en:"Greece"},{fr:"Groenland",en:"Greenland"},{fr:"Grenade",en:"Grenada"},{fr:"Guatemala",en:"Guatemala"},{fr:"Guinée",en:"Guinea"},{fr:"Guinée-Bissau",en:"Guinea-Bissau"},{fr:"Guyanne",en:"Guyana"},{fr:"Haïti",en:"Haiti"},{fr:"Honduras",en:"Honduras"},{fr:"Hong-Kong",en:"Hong Kong"},{fr:"Hongrie",en:"Hungary"},{fr:"Islande",en:"Iceland"},{fr:"Inde",en:"India"},{fr:"Indonésie",en:"Indonesia"},{fr:"Iran",en:"Iran"},{fr:"Irak",en:"Iraq"},{fr:"Irlande",en:"Ireland"},{fr:"Israël",en:"Israel"},{fr:"Italie",en:"Italy"},{fr:"Jamaïque",en:"Jamaica"},{fr:"Japon",en:"Japan"},{fr:"Jordanie",en:"Jordan"},{fr:"Kazakhstan",en:"Kazakhstan"},{fr:"Kenya",en:"Kenya"},{fr:"Kiribati",en:"Kiribati"},{fr:"Korea, North",en:"Korea, North"},{fr:"Korea, South",en:"Korea, South"},{fr:"Koweït",en:"Kuwait"},{fr:"Kirghizistan",en:"Kyrgyzstan"},{fr:"Laos",en:"Laos"},{fr:"Lettonie",en:"Latvia"},{fr:"Liban",en:"Lebanon"},{fr:"Lesotho",en:"Lesotho"},{fr:"Libéria",en:"Liberia"},{fr:"Libya",en:"Libya"},{fr:"Liechtenstein",en:"Liechtenstein"},{fr:"Lituanie",en:"Lithuania"},{fr:"Luxembourg",en:"Luxembourg"},{fr:"Macedonia",en:"Macedonia"},{fr:"Madagascar",en:"Madagascar"},{fr:"Malawi",en:"Malawi"},{fr:"Malaisie",en:"Malaysia"},{fr:"Maldives",en:"Maldives"},{fr:"Mali",en:"Mali"},{fr:"Malte",en:"Malta"},{fr:"Iles Marshall",en:"Marshall Islands"},{fr:"Mauritanie",en:"Mauritania"},{fr:"Île Maurice",en:"Mauritius"},{fr:"Mexique",en:"Mexico"},{fr:"Micronésie",en:"Micronesia"},{fr:"Moldova",en:"Moldova"},{fr:"Mongolie",en:"Mongolia"},{fr:"Maroc",en:"Morocco"},{fr:"Monaco",en:"Monaco"},{fr:"Montenegro",en:"Montenegro"},{fr:"Mozambique",en:"Mozambique"},{fr:"Namibie",en:"Namibia"},{fr:"Nauru",en:"Nauru"},{fr:"Népal",en:"Nepal"},{fr:"Pays-Bas",en:"Netherlands"},{fr:"Nouvelle-Zélande",en:"New Zealand"},{fr:"Nicaragua",en:"Nicaragua"},{fr:"Niger",en:"Niger"},{fr:"Nigéria",en:"Nigeria"},{fr:"Norvège",en:"Norway"},{fr:"Oman",en:"Oman"},{fr:"Pakistan",en:"Pakistan"},{fr:"Panama",en:"Panama"},{fr:"Papouasie-Nouvelle-Guinée",en:"Papua New Guinea"},{fr:"Paraguay",en:"Paraguay"},{fr:"Pérou",en:"Peru"},{fr:"Philippines",en:"Philippines"},{fr:"Pologne",en:"Poland"},{fr:"Portugal",en:"Portugal"},{fr:"Qatar",en:"Qatar"},{fr:"Roumanie",en:"Romania"},{fr:"Russia",en:"Russia"},{fr:"Rwanda",en:"Rwanda"},{fr:"Samoa",en:"Samoa"},{fr:"Saint-Marin",en:"San Marino"},{fr:"Sao Tome",en:"Sao Tome"},{fr:"Arabie Saoudite",en:"Saudi Arabia"},{fr:"Sénégal",en:"Senegal"},{fr:"Serbia",en:"Serbia"},{fr:"Seychelles",en:"Seychelles"},{fr:"Sierra Leone",en:"Sierra Leone"},{fr:"Singapour",en:"Singapore"},{fr:"Slovaquie",en:"Slovakia"},{fr:"Slovénie",en:"Slovenia"},{fr:"Salomon, Îles",en:"Solomon Islands"},{fr:"Somalie",en:"Somalia"},{fr:"Afrique du Sud",en:"South Africa"},{fr:"Espagne",en:"Spain"},{fr:"Sri Lanka",en:"Sri Lanka"},{fr:"Soudan",en:"Sudan"},{fr:"Surinam",en:"Suriname"},{fr:"Swaziland",en:"Swaziland"},{fr:"Suède",en:"Sweden"},{fr:"Suisse",en:"Switzerland"},{fr:"Syria",en:"Syria"},{fr:"Taiwan",en:"Taiwan"},{fr:"Tadjikistan",en:"Tajikistan"},{fr:"Tanzania",en:"Tanzania"},{fr:"Thaïlande",en:"Thailand"},{fr:"Togo",en:"Togo"},{fr:"Tonga",en:"Tonga"},{fr:"Trinidad and Tobago",en:"Trinidad and Tobago"},{fr:"Tunisie",en:"Tunisia"},{fr:"Turquie",en:"Turkey"},{fr:"Turkménistan",en:"Turkmenistan"},{fr:"Ouganda",en:"Uganda"},{fr:"Ukraine",en:"Ukraine"},{fr:"Émirats Arabes Unis",en:"United Arab Emirates"},{fr:"United Kingdom",en:"United Kingdom"},{fr:"United States",en:"United States"},{fr:"Uruguay",en:"Uruguay"},{fr:"Ouzbékistan",en:"Uzbekistan"},{fr:"Vanuatu",en:"Vanuatu"},{fr:"Venezuela",en:"Venezuela"},{fr:"Vietnam",en:"Vietnam"},{fr:"Yémen",en:"Yemen"},{fr:"Zambie",en:"Zambia"},{fr:"Zimbabwe",en:"Zimbabwe"}],name:"Countries"},{type:"vertical",values:[{fr:"Africa",en:"Africa"},{fr:"Antarctique",en:"Antarctica"},{fr:"Asia",en:"Asia"},{fr:"Australie",en:"Australia"},{fr:"Europe",en:"Europe"},{fr:"North America",en:"North America"},{fr:"South America",en:"South America"}],name:"Continents"},{type:"vertical horizontal",values:[{fr:"Everyday",en:"Everyday"},{fr:"Once a week",en:"Once a week"},{fr:"2 to 3 times a month",en:"2 to 3 times a month"},{fr:"Once a month",en:"Once a month"},{fr:"Less than once a month",en:"Less than once a month"}],name:"How Often?"},{type:"vertical horizontal",values:[{fr:"Jamais",en:"Never"},{fr:"Rarely",en:"Rarely"},{fr:"Sometimes",en:"Sometimes"},{fr:"Often",en:"Often"},{fr:"Always",en:"Always"}],name:"Frequency"},{type:"vertical horizontal",values:[{fr:"Less than a month",en:"Less than a month"},{fr:"1-6 months",en:"1-6 months"},{fr:"1-3 years",en:"1-3 years"},{fr:"Over 3 Years",en:"Over 3 Years"},{fr:"Never used",en:"Never used"}],name:"How Long?"},{type:"vertical",values:[{fr:"Very Satisfied",en:"Very Satisfied"},{fr:"Satisfied",en:"Satisfied"},{fr:"Neutral",en:"Neutral"},{fr:"Unsatisfied",en:"Unsatisfied"},{fr:"Very Unsatisfied",en:"Very Unsatisfied"},{fr:"Non applicable",en:"N/A"}],name:"Satisfaction"},{type:"horizontal",values:[{fr:"Very Unsatisfied",en:"Very Unsatisfied"},{fr:"Unsatisfied",en:"Unsatisfied"},{fr:"Neutral",en:"Neutral"},{fr:"Satisfied",en:"Satisfied"},{fr:"Very Satisfied",en:"Very Satisfied"}],name:"Satisfaction"},{type:"vertical",values:[{fr:"Very Important",en:"Very Important"},{fr:"Important",en:"Important"},{fr:"Neutral",en:"Neutral"},{fr:"Somewhat Important",en:"Somewhat Important"},{fr:"Not at all Important",en:"Not at all Important"},{fr:"Non applicable",en:"N/A"}],name:"Importance"},{type:"horizontal",values:[{fr:"Not at all Important",en:"Not at all Important"},{fr:"Somewhat Important",en:"Somewhat Important"},{fr:"Neutral",en:"Neutral"},{fr:"Important",en:"Important"},{fr:"Very Important",en:"Very Important"}],name:"Importance"},{type:"vertical",values:[{fr:"Very Happy",en:"Very Happy"},{fr:"Happy",en:"Happy"},{fr:"Indifferent",en:"Indifferent"},{fr:"Unhappy",en:"Unhappy"},{fr:"Very Unhappy",en:"Very Unhappy"},{fr:"Non applicable",en:"N/A"}],name:"Happiness"},{type:"horizontal",values:[{fr:"Very Unhappy",en:"Very Unhappy"},{fr:"Unhappy",en:"Unhappy"},{fr:"Indifferent",en:"Indifferent"},{fr:"Happy",en:"Happy"},{fr:"Very Happy",en:"Very Happy"}],name:"Happiness"},{type:"vertical",values:[{fr:"Strongly Agree",en:"Strongly Agree"},{fr:"Agree",en:"Agree"},{fr:"Neutral",en:"Neutral"},{fr:"Disagree",en:"Disagree"},{fr:"Strongly Disagree",en:"Strongly Disagree"},{fr:"Non applicable",en:"N/A"}],name:"Agreement"},{type:"horizontal",values:[{fr:"Strongly Disagree",en:"Strongly Disagree"},{fr:"Disagree",en:"Disagree"},{fr:"Neutral",en:"Neutral"},{fr:"Agree",en:"Agree"},{fr:"Strongly Agree",en:"Strongly Agree"}],name:"Agreement"},{type:"vertical",values:[{fr:"Much Better",en:"Much Better"},{fr:"Somewhat Better",en:"Somewhat Better"},{fr:"About the Same",en:"About the Same"},{fr:"Somewhat Worse",en:"Somewhat Worse"},{fr:"Much Worse",en:"Much Worse"},{fr:"Don't Know",en:"Don't Know"}],name:"Comparison"},{type:"horizontal",values:[{fr:"Much Worse",en:"Much Worse"},{fr:"Somewhat Worse",en:"Somewhat Worse"},{fr:"About the Same",en:"About the Same"},{fr:"Somewhat Better",en:"Somewhat Better"},{fr:"Much Better",en:"Much Better"}],name:"Comparison"},{type:"vertical",values:[{fr:"Definitely",en:"Definitely"},{fr:"Probably",en:"Probably"},{fr:"Not Sure",en:"Not Sure"},{fr:"Probably Not",en:"Probably Not"},{fr:"Definitely Not",en:"Definitely Not"}],name:"Probability"},{type:"horizontal",values:[{fr:"Definitely Not",en:"Definitely Not"},{fr:"Probably Not",en:"Probably Not"},{fr:"Not Sure",en:"Not Sure"},{fr:"Probably",en:"Probably"},{fr:"Definitely",en:"Definitely"}],name:"Probability"},{type:"vertical horizontal",values:[{en:"1"},{en:"2"},{en:"3"},{en:"4"},{en:"5"},{en:"6"},{en:"7"},{en:"8"},{en:"9"},{en:"10"}],name:"10 Scale"},{type:"vertical",values:[{en:"Male"},{en:"Female"},{en:"Prefer Not to Answer"}],name:"Gender"},{type:"vertical horizontal",values:[{en:"2013"},{en:"2012"},{en:"2011"},{en:"2010"},{en:"2009"},{en:"2008"},{en:"2007"},{en:"2006"},{en:"2005"},{en:"2004"},{en:"2003"},{en:"2002"},{en:"2001"},{en:"2000"},{en:"1999"},{en:"1998"},{en:"1997"},{en:"1996"},{en:"1995"},{en:"1994"},{en:"1993"},{en:"1992"},{en:"1991"},{en:"1990"},{en:"1989"},{en:"1988"},{en:"1987"},{en:"1986"},{en:"1985"},{en:"1984"},{en:"1983"},{en:"1982"},{en:"1981"},{en:"1980"},{en:"1979"},{en:"1978"},{en:"1977"},{en:"1976"},{en:"1975"},{en:"1974"},{en:"1973"},{en:"1972"},{en:"1971"},{en:"1970"},{en:"1969"},{en:"1968"},{en:"1967"},{en:"1966"},{en:"1965"},{en:"1964"},{en:"1963"},{en:"1962"},{en:"1961"},{en:"1960"},{en:"1959"},{en:"1958"},{en:"1957"},{en:"1956"},{en:"1955"},{en:"1954"},{en:"1953"},{en:"1952"},{en:"1951"},{en:"1950"},{en:"1949"},{en:"1948"},{en:"1947"},{en:"1946"},{en:"1945"},{en:"1944"},{en:"1943"},{en:"1942"},{en:"1941"},{en:"1940"},{en:"1939"},{en:"1938"},{en:"1937"},{en:"1936"},{en:"1935"},{en:"1934"},{en:"1933"},{en:"1932"},{en:"1931"},{en:"1930"},{en:"1929"},{en:"1928"},{en:"1927"},{en:"1926"},{en:"1925"},{en:"1924"},{en:"1923"},{en:"1922"},{en:"1921"},{en:"1920"},{en:"1919"},{en:"1918"},{en:"1917"},{en:"1916"},{en:"1915"},{en:"1914"},{en:"1913"},{en:"1912"},{en:"1911"},{en:"1910"},{en:"1909"},{en:"1908"},{en:"1907"},{en:"1906"},{en:"1905"},{en:"1904"},{en:"1903"},{en:"1902"},{en:"1901"},{en:"1900"}],name:"Years"}];$(document).ready(function(){sf_createQuestions(),$.fn.selectpicker&&$(".selectpicker").selectpicker(),$("#CKeditor").text(""),CKEDITOR.replace("CKeditor"),$("#sf_date_started").datepicker({showOn:"button",buttonText:COM_SURVEYFORCE_SELECT_DATE,showOptions:{direction:"up"}}),$("#sf_date_expired").datepicker({showOn:"button",buttonText:COM_SURVEYFORCE_SELECT_DATE,showOptions:{direction:"up"}}),$("li.tool, a.tool").tooltip({hide:{effect:"explode",delay:250}}),$("#basicquestions li").draggable({appendTo:"body",helper:"clone",start:function(e,t){dropped=!1,t.helper.addClass("tools-move")}}),$("#survey-questions"+currPage).droppable({drop:function(e,t){qtype=$(t.helper).attr("field-type"),sfAddQuestion(qtype)}}).sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",stop:function(e,t){sf_SortQuestions(e,t)}}),$(".viewport .tabs").sortable({placeholder:"ui-state-highlight",cursor:"move",stop:function(e,t){sfOrderingPages(e,t),sf_SortQuestions(e,t)}})});var sfPublishSurvey=function(e,t){return window.location.href=t+"index.php?option=com_surveyforce&view=survey&id="+e,!1},sf_SortQuestions=function(e,t){var s=0,n=[],a=$(".page");$(a).each(function(){var e=$(this).find("li.field");for(var t in $(e).each(function(){var e=$(this).attr("id");questionsStack[e]&&(questionsStack[e].questOrdering=s),s++}),questionsStack)if("page-break"==questionsStack[t].sf_qtype&&!sf_inArray(n,t)){questionsStack[t].questOrdering=s,s++,n.push(t);break}})},sf_inArray=function(e,t){if(!e.length)return!1;for(var s=0;s<e.length;s++)if(e[s]==t)return!0;return!1},sf_createQuestions=function(){if(questionsStack){for(var e in $(".placeholder").remove(),questionsStack){var t='<li class="field" name="'+questionsStack[e].sf_qtype+'" style="" id="'+e+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">'+questionsStack[e].sf_qtitle+'</h3><div class="description"></div>{ANSWERS}</li>';switch(questionsStack[e].sf_qtype){case"section-separator":if((i=questionsStack[e].sections).length)for(var s=0;s<i.length;s++)for(var n in qid=i[s],questionsStack)questionsStack[n].id==qid&&(questionsStack[e].sections[s]=n);t=t.replace("{ANSWERS}","");break;case"pick-one":case"pick-many":var a="pick-one"==questionsStack[e].sf_qtype?"radio":"checkbox",i=sfGenerateID();if(questionsStack[e].answers.length){for(r='<ul class="choices" data-id="'+i+'">',s=0;s<questionsStack[e].answers.length;s++)r+='<li class="choice"><label><label class="clean-input-wrap"><input type="'+a+'" name="'+i+'"><span class="clean-input"></span></label><span class="choice-value">'+questionsStack[e].answers[s].title+"</span></label></li>";questionsStack[e].answers[0].other_option&&(r+='<li class="choice other"><label><label class="clean-input-wrap"><input type="radio" name="'+i+'"><span class="clean-input"></span></label> <span class="choice-value">'+questionsStack[e].answers[0].other_option_text+'</span><input type="text" "="" class="text dummy"></label></li>'),r+="</ul>",t=t.replace("{ANSWERS}",r)}break;case"short-answer":t=(t=sfReplaceShortAnswer(t)).replace("{ANSWERS}","");break;case"ranking":case"ranking-dragdrop":if(i=sfGenerateID(),questionsStack[e].answers.length){if("ranking"==questionsStack[e].sf_qtype){var r='<ul class="choices" data-id="'+i+'">';for(a="<select>",s=0;s<questionsStack[e].answers.length;s++)a+='<option value="'+questionsStack[e].answers[s].right+'">'+questionsStack[e].answers[s].right+"</option>";for(a+="</select>",s=0;s<questionsStack[e].answers.length;s++)r+='<li class="ranking-left">'+questionsStack[e].answers[s].left+'</li><li class="ranking-right">'+a+'</li><li class="ranking-break">';r+="</ul>"}if("ranking-dragdrop"==questionsStack[e].sf_qtype){for(r='<ul class="choices" data-id="'+i+'">',s=0;s<questionsStack[e].answers.length;s++)r+='<li class="ranking-left fixed">'+questionsStack[e].answers[s].left+'</li><li class="ranking-right ui-widget-header dragable">'+questionsStack[e].answers[s].right+'</li><li class="ranking-break">';r+="</ul>"}t=t.replace("{ANSWERS}",r)}break;case"boilerplate":t=t.replace("{ANSWERS}","");break;case"ranking-dropdown":case"likert-scale":if(i=sfGenerateID(),"ranking-dropdown"==questionsStack[e].sf_qtype){if(r='<ul class="choices" data-id="'+i+'">',a="<select>",questionsStack[e].answers.ranks.length)for(s=0;s<questionsStack[e].answers.ranks.length;s++)a+='<option value="'+questionsStack[e].answers.ranks[s]+'">'+questionsStack[e].answers.ranks[s]+"</option>";if(a+="</select>",questionsStack[e].answers.options.length)for(s=0;s<questionsStack[e].answers.options.length;s++)r+='<li class="ranking-left">'+questionsStack[e].answers.options[s]+'</li><li class="ranking-right">'+a+'</li><li class="ranking-break">';r+="</ul>"}if("likert-scale"==questionsStack[e].sf_qtype){if(r='<table class="likert-scale">',i="<thead><tr><th></th>",questionsStack[e].answers.scales.length)for(s=0;s<questionsStack[e].answers.scales.length;s++)i+="<th>"+questionsStack[e].answers.scales[s]+"</th>";if(r+=i+="</tr></thead>",a="<tbody>",questionsStack[e].answers.options.length)for(s=0;s<questionsStack[e].answers.options.length;s++){if(a+='<tr nameid="'+(i=sfGenerateID())+'">',a+="<td>"+questionsStack[e].answers.options[s]+"</td>",questionsStack[e].answers.scales.length)for(var o=0;o<questionsStack[e].answers.scales.length;o++)a+='<td><label class="clean-input-wrap"><input type="radio" name="'+i+'"><span class="clean-input"></span></label></td>';a+="</tr>"}r+=a+="</tbody></table>"}t=t.replace("{ANSWERS}",r);break;case"page-break":sfAddPage(!1,e),$(".placeholder").remove();continue}questionsStack[e].page=currPage,$("#survey-questions"+currPage).append(t),sfSelectQuestion(e)}for(e in questionsStack){if(questionsStack[e].hides.length)for(t=0;t<questionsStack[e].hides.length;t++){n=questionsStack[e].hides[t].question;var l;i=questionsStack[e].hides[t].answer;for(l in questionsStack)if(questionsStack[l].id==n){switch(questionsStack[e].hides[t].question=l,questionsStack[l].sf_qtype){case"pick-one":case"pick-many":if(questionsStack[l].answers.length)for(s=0;s<questionsStack[l].answers.length;s++)if(questionsStack[l].answers[s].id==i){questionsStack[e].hides[t].answer=s+1;break}break;case"ranking-dragdrop":case"ranking":if(questionsStack[l].answers.length)for(s=0;s<questionsStack[l].answers.length;s++)if(questionsStack[l].answers[s].leftid==i){questionsStack[e].hides[t].answer=s+1;break}break;case"ranking-dropdown":case"likert-scale":if(questionsStack[l].answers.oid.length)for(s=0;s<questionsStack[l].answers.oid.length;s++)if(questionsStack[l].answers.oid[s]==i){questionsStack[e].hides[t].answer=s+1;break}}break}}if(questionsStack[e].rules.length)for(t=0;t<questionsStack[e].rules.length;t++){switch(n=questionsStack[e].rules[t].question,i=questionsStack[e].rules[t].answer,r=questionsStack[e].rules[t].option,questionsStack[e].sf_qtype){case"pick-one":case"pick-many":if(questionsStack[e].answers.length)for(s=0;s<questionsStack[e].answers.length;s++)if(questionsStack[e].answers[s].id==i){questionsStack[e].rules[t].answer=s+1;break}break;case"ranking-dragdrop":case"ranking":if(questionsStack[e].answers.length){for(s=0;s<questionsStack[e].answers.length;s++)if(questionsStack[e].answers[s].rightid==i){questionsStack[e].rules[t].answer=s+1;break}for(s=0;s<questionsStack[e].answers.length;s++)if(questionsStack[e].answers[s].leftid==r){questionsStack[e].rules[t].option=s+1;break}}break;case"ranking-dropdown":case"likert-scale":if(questionsStack[e].answers.oid.length){for(s=0;s<questionsStack[e].answers.oid.length;s++)if(questionsStack[e].answers.oid[s]==r){questionsStack[e].rules[t].option=s+1;break}for(s=0;s<questionsStack[e].answers.oid.length;s++)if("ranking-dropdown"==questionsStack[e].sf_qtype){if(questionsStack[e].answers.rid[s]==i){questionsStack[e].rules[t].answer=s+1;break}}else if(questionsStack[e].answers.sid[s]==i){questionsStack[e].rules[t].answer=s+1;break}}}for(l in questionsStack)if(questionsStack[l].id==n){questionsStack[e].rules[t].question=l;break}}}}sfSelectPage(1)},sfSelectQuestion=function(e){$("#"+e).bind("click",function(){return sfClearActives(),$(this).addClass("active"),$(this).find("i.remove").css("opacity","1"),currQuestion=$(this),sfGetOptions(e),!0})},sfAddPage=function(e,t){e&&(t=sfGenerateID(),questionsStack[t]={},questionsStack[t].exists=1,questionsStack[t].published=1,questionsStack[t].sf_qtitle="Page Break",questionsStack[t].sf_qtype="page-break",questionsStack[t].is_final_question=0,questionsStack[t].sf_compulsory=0,questionsStack[t].sf_default_hided=0,questionsStack[t].questOrdering=questOrdering,questOrdering++);var s=lastPage;lastPage+=1;var n=$("#page"+s+" div.title").html();return $("#page"+currPage).hide(),$('<div class="pages" id="page'+lastPage+'" questid="'+t+'"><div class="title">'+n+'</div><ol id="survey-questions'+lastPage+'" class="page active"><li class="placeholder" style="display: list-item;">'+COM_SF_YOU_HAVANT_ADDED_WITH_SLASH+"</li></ol></div>").insertAfter(".viewport #page"+s),$("#page"+lastPage).show(),$("#tab"+currPage).removeClass("active"),s='<a style="" name="0" class="button button-tab-bottom page-button active" href="#" id="tab'+lastPage+'" onclick="javascript:sfSelectPage('+lastPage+');">'+lastPage+"</a>",$(".viewport .tabs").append(s),$("#survey-questions"+lastPage).droppable({drop:function(e,t){qtype=$(t.helper).attr("field-type"),sfAddQuestion(qtype)}}).sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",stop:function(e,t){sf_SortQuestions(e,t)}}),currQuestion=null,$("ol.page li.field").removeClass("active"),$("ol.page li.field i.remove").css("opacity","0.2"),currPage=lastPage,sfRemoveChoicesPanel(),sfDisableOptions(),sf_SortQuestions(),sfGoToAddQuestion(),!0},sfSelectPage=function(e){return $("#page"+currPage).hide(),$("#page"+e).show(),$(".viewport .tabs #tab"+currPage).removeClass("active"),$(".viewport .tabs #tab"+e).addClass("active"),$("#survey-questions"+e).droppable({drop:function(e,t){qtype=$(t.helper).attr("field-type"),sfAddQuestion(qtype)}}).sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",stop:function(e,t){sf_SortQuestions(e,t)}}),currPage=e,currQuestion=null,$("ol.page li.field").removeClass("active"),$("ol.page li.field i.remove").css("opacity","0.2"),sfRemoveChoicesPanel(),sfDisableOptions(),sfGoToAddQuestion(),!0},sfDeletePage=function(){1<lastPage&&$("#dialog-pageremove-confirm").dialog({autoOpen:!0,height:300,width:350,modal:!0,buttons:{Yes:function(){sfRemovePage(),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})},sfRemovePage=function(){var e,t=[];for(e in questionsStack)questionsStack[e].page==currPage&&t.push(e);if(t.length)for(e=0;e<t.length;e++)delete questionsStack[t[e]];return t=$("#page"+currPage).attr("questid"),delete questionsStack[t],$("#page"+currPage).remove(),$(".viewport .tabs #tab"+currPage).remove(),t=sfReorderPages(),$("#page"+t).show(),$(".viewport .tabs #tab"+t).addClass("active"),currPage=t,currQuestion=null,$("ol.page li.field").removeClass("active"),$("ol.page li.field i.remove").css("opacity","0.2"),sfRemoveChoicesPanel(),sfDisableOptions(),sfGoToAddQuestion(),!0},sfReorderPages=function(){var e=currPage-1;e||(e=currPage);for(var t=currPage+1;t<=lastPage;t++)for(question in questionsStack)questionsStack[question].page==t&&(questionsStack[question].page=t-1);for(t=currPage+1;t<=lastPage;t++)if($("#page"+t)){var s=t-1;$("#page"+t).attr("id","page"+s),$("#survey-questions"+t).attr("id","survey-questions"+s),$(".viewport .tabs #tab"+t).text(s),$(".viewport .tabs #tab"+t).attr("onclick","javascript:sfSelectPage("+s+");"),$(".viewport .tabs #tab"+t).attr("id","tab"+s)}return--lastPage,e},sfOrderingPages=function(e,t){var s=parseInt($(t.item).text()),n=parseInt($(t.item).prev().text()),a=parseInt($(t.item).next().text()),i=$(".viewport .tabs a");(n||a)&&(n?$("#page"+s).insertAfter("#page"+n):a&&$("#page"+s).insertBefore("#page"+a));var r=$(".viewport .pages"),o=1;return $(r).each(function(e){var t=$(r[e]).find(".page li").not(".placeholder");t.length&&$(t).each(function(e){e=$(t[e]).attr("id"),questionsStack[e]&&(questionsStack[e].page=o)}),o++}),o=1,$(r).each(function(e){$(r[e]).attr("id","page"+o),$(r[e]).find(".page").attr("id","survey-questions"+o),$(i[e]).text(o),$(i[e]).attr("onclick","javascript:sfSelectPage("+o+");"),$(i[e]).attr("id","tab"+o),o++}),currPage=parseInt($(".viewport .tabs a.active").text()),!0},sfOpenCKEEditor=function(e,t){var s=$(e).parent().prev().val();return CKEDITOR.instances.CKeditor.destroy(),$("#CKeditor").val(s),CKEDITOR.replace("CKeditor"),$("#dialog-editor").dialog({autoOpen:!0,width:700,modal:!0,buttons:{Ok:function(){var n=CKEDITOR.instances.CKeditor.getData();$(e).parent().prev().val(n),$("#CKeditor").val(s);var a=$(currQuestion).attr("id");switch(t){case"questionTitle":questionsStack[a].sf_qtitle=n,"short-answer"==questionsStack[a].sf_qtype&&(n=sfReplaceShortAnswer(n)),$(currQuestion).find("h3.title").html(n);break;case"questionDescr":$(currQuestion).find("div.description").html(n),questionsStack[a].sf_qdescription=n;break;case"surveyDescr":$(".viewport div.title p.description").html(n)}$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}),!0},sfClone=function(e){var t,s={};for(t in e)if(e[t]instanceof Array){var n=[];if(e[t].length)for(var a=0;a<e[t].length;a++)for(var i in n[a]={},e[t][a])n[a][i]=e[t][a][i];s[t]=n}else s[t]=e[t];return s},sfMoveQuestionToAction=function(e){$("#page"+e+" .placeholder").remove();var t=$(currQuestion).attr("id");return questionsStack[t].page=e,$("#page"+e+" #survey-questions"+e).append(currQuestion),$("#page"+e).css("display","block"),$("#page"+currPage).css("display","none"),$(".viewport .tabs a").removeClass("active"),$(".viewport .tabs #tab"+e).addClass("active"),currPage=e,sf_SortQuestions(),!0},sfMoveQuestionTo=function(){$("#sf_move_to").html(""),$("#sf_move_to").html("<option value=''>"+COM_SURVEYFORCE_SELECT_PAGE+"</option>");for(var e=1;e<=lastPage;e++)if(e!=currPage){var t="<option value='"+e+"'>"+e+"</oprion>";$("#sf_move_to").append(t)}return $("#dialog-move-to").dialog({autoOpen:!0,height:300,width:350,modal:!0,buttons:{Move:function(){var e=$("#sf_move_to").val();if(""==e)return alert(COM_SURVEYFORCE_SELECT_PAGE),!0;sfMoveQuestionToAction(e),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}),!0},sfDublicateQuestion=function(){var e=$(currQuestion).attr("id"),t=sfGenerateID(),s=$(currQuestion).clone();return $(s).attr("id",t),$("#survey-questions"+currPage).append(s),questionsStack[t]=sfClone(questionsStack[e]),sfClearActives(),$("#"+t).addClass("active"),$("#"+t+" i.remove").css("opacity","1"),$("#survey-questions"+currPage).selectable(),$("#"+t).click(function(){return sfClearActives(),$(this).addClass("active"),$(this).find("i.remove").css("opacity","1"),currQuestion=$(this),sfGetOptions(t),!0}),"pick-one"==$("#"+t).attr("name")&&(e=sfGenerateID(),$("#"+t).find(".choices").attr("data-id",e),$("#"+t).find(".choices li.choice input").attr("name",e)),currQuestion=s,sf_SortQuestions(),!0},sfNextStep=function(){return $("#sf_name").val()?(sf_step++,$("#sf_step").val(sf_step),sfSaveSurvey(!1),2==sf_step&&($("#surveyButton").removeClass("active"),$("#survey").removeClass("active"),$("#questionsButton").removeClass("disabled"),$("#questionsButton").addClass("active"),$("#questions").addClass("active"),$("#questions").removeAttr("style"),$("#survey").find(".nextButton").remove(),$("#questions").append('<div class="nextButton"><button class="btn btn-primary" onclick="sfNextStep();return false;">Next step</button></div>'),$("#questionsButton a").click(function(e){e.preventDefault(),$(this).tab("show")}),$(".done").css("left","7px"),$(".done").css("width","148px"),$(".not-done").css("left","154px"),$(".not-done").css("width","300px")),3==sf_step&&($("#questionsButton").removeClass("active"),$("#questions").removeClass("active"),$("#pageButton").removeClass("disabled"),$("#pageButton").addClass("active"),$("#page").addClass("active"),$("#page").removeAttr("style"),$("#questions").find(".nextButton").remove(),$("#pageButton a").click(function(e){e.preventDefault(),$(this).tab("show")}),$(".done").css("left","7px"),$(".done").css("width","455px"),$(".not-done").hide()),!0):(notif({type:"info",msg:"Fill survey name please.",position:"right",fade:!0,timeout:3e3}),$("#sf_name").focus(),!1)},sfGoToAddQuestion=function(){return 2>sf_step?(notif({type:"info",msg:"Click on 'Next step' to add question",position:"right",fade:!0,timeout:3e3}),!1):($(".tab-pane").removeClass("active"),$(".nav-tabs li").removeClass("active"),$("#questionsButton").addClass("active"),$("#questions").addClass("active"),$("#basic").addClass("in"),$("#collapseProperties").removeClass("in"),$("#collapseChoices").removeClass("in"),sfDisableOptions(),!0)},sfChangeQuestionTitle=function(){var e=$("textarea[name='sf_qtitle']").val(),t=$(currQuestion).attr("id");return questionsStack[t].sf_qtitle=e,"short-answer"==questionsStack[t].sf_qtype&&(e=sfReplaceShortAnswer(e)),$("li#"+t).find("h3.title").html(e),refreshQuestionsList(),changeQuestionInHides(),!0},sfChangeQuestionDescription=function(){var e=$("textarea[name='sf_qdescription']").val(),t=$(currQuestion).attr("id");return $("li#"+t).find("div.description").html(e),questionsStack[t].sf_qdescription=e,!0},sfSelectCheckbox=function(e){var t=$(e).attr("name"),s=$(currQuestion).attr("id");if($(e).prop("checked"))var n=1;else $(e).prop("checked")||(n=0);return questionsStack[s][t]=n,!0},sfRemoveImage=function(){return $("#image_file").val(""),$("#sf_image").val(""),$("#bkg_thumb span").remove(),$(".pages").css("background","white"),!0},sfSelectFile=function(e){return $(e).next().click(),file=e,fileInterval=setInterval("sfCheckSelectFile()",300),!0},sfCheckSelectFile=function(){if(""!=$(file).next().val()){var e=$(file).next().val();clearInterval(fileInterval),$(file).prev().val(e),window.File&&window.FileReader&&window.FileList&&window.Blob?document.getElementById("image_file").addEventListener("change",handleFileSelect,!1):alert(COM_SURVEYFORCE_FILE_API_ARE_NOT_SUPPORTED)}return!0},handleFileSelect=function(e){e=e.target.files;for(var t,s=0;t=e[s];s++)if(t.type.match("image.*")){var n=new FileReader;n.onload=function(e){return function(t){$("#bkg_thumb span").remove();var s=document.createElement("span");s.innerHTML=['<img class="thumb" src="',t.target.result,'" title="',escape(e.name),'"/>'].join(""),$("#bkg_thumb").append(s),$(".pages").css("background","url("+t.target.result+")")}}(t),n.readAsDataURL(t)}},sfOpenEditButton=function(e){return $(e).next().slideDown(),!0},sfCloseEditButton=function(e){return $(e).next().slideUp(),!0},sfChangeSurveyName=function(){var e=$("#sf_name").val();return $("h2.title").text(e),!0},sfChangeSurveyDescr=function(){var e=$("#sf_descr").val();return $("p.description").html(e),!0},sfDeleteQuestion=function(e){var t=e?$(e).parent():currQuestion;return e=$(t).attr("id"),$(t).fadeOut(400,function(){$(t).remove(),$("#fieldProperties").css("display","none"),$("#Settings").css("display","none"),$("#fieldPropertiesDisable").css("display","block"),$("#SettingsDisable").css("display","block"),$("#panelActions").css("display","none"),sfRemoveChoicesPanel()}),delete questionsStack[e],currQuestion=null,refreshQuestionsList(),refreshAnswersList(),sf_SortQuestions(),!0},sfRemoveQuestion=function(e){return $("#dialog-confirm").dialog({autoOpen:!0,height:300,width:350,modal:!0,buttons:{Yes:function(){sfDeleteQuestion(e),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}),!0},sfRefreshBulkList=function(e){var t="";if(e=$(e).val(),BULKS.length)for(var s=0;s<BULKS.length;s++)if(bulkObject=BULKS[s],e==bulkObject.name){for(e=bulkObject.values,s=0;s<e.length;s++)t+=bulkObject.values[s].en+"\n";$("#bulk_list").val(t);break}return!0},sfAddBulkList=function(e,t){var s=$(currQuestion).attr("id");if(questionsStack[s].answers[0].other_option=0,questionsStack[s].answers[0].other_option_text="",delete questionsStack[s].answers,questionsStack[s].answers=[],questionsStack[s].choiceStyle?$("#"+s+" .choices option").remove():$("#"+s+" .choices li").remove(),$("#choices-list li").remove(),BULKS.length)for(s=0;s<BULKS.length;s++)if(bulkObject=BULKS[s],e==bulkObject.name){s=bulkObject.values;for(var n=0;n<s.length;n++)sfAddChoice(bulkObject.values[n].en,!0,t);break}return $("#other_option_cb").prop("checked",!1),$("#other_option").val(""),!0},sfDialogBulkList=function(e){return $("#dialog-bulk").dialog({autoOpen:!0,height:400,width:550,modal:!0,buttons:{Add:function(){var t=$("#bulk-selector").val();sfAddBulkList(t,e),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}),!0},sfAddQuestion=function(e){var t=sfGenerateID();switch(e){case"section-separator":var s='<li class="field" name="section-separator" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Section Heading</h3><div class="description"></div></li>';break;case"pick-one":s='<li class="field" name="pick-one" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><ul class="choices" data-id="'+(s=sfGenerateID())+'"><li class="choice"><label><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label> <span class="choice-value">Choice 1</span></label></li><li class="choice"><label><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label> <span class="choice-value">Choice 2</span></label></li></ul></li>';break;case"pick-many":s='<li class="field" name="pick-many" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><ul class="choices" data-id="'+(s=sfGenerateID())+'"><li class="choice"><label><label class="clean-input-wrap"><input type="checkbox" name="'+s+'"><span class="clean-input"></span></label> <span class="choice-value">Choice 1</span></label></li><li class="choice"><label><label class="clean-input-wrap"><input type="checkbox" name="'+s+'"><span class="clean-input"></span></label><span class="choice-value">Choice 2</span></label></li></ul></li>';break;case"ranking":s='<li class="field" name="ranking" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><ul class="choices" data-id="'+(s=sfGenerateID())+'"><li class="ranking-left">Option 1</li><li class="ranking-right"><select><option value="Rank 1">Rank 1</option><option value="Rank 2">Rank 2</option></select></li><li class="ranking-break"></li><li class="ranking-left">Option 2</li><li class="ranking-right"><select><option value="Rank 1">Rank 1</option><option value="Rank 2">Rank 2</option></select></li><li class="ranking-break"></li></ul></li>';break;case"short-answer":s=sfReplaceShortAnswer('<li class="field" name="short-answer" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Every {x} in question text will be replaced by input box. If the number of {x} is more than zero no large text area will be displayed. To place text area with input box in question text use {y} tag.</h3><div class="description"></div></li>');break;case"ranking-dragdrop":s='<li class="field" name="ranking-dragdrop" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><ul class="choices" data-id="'+(s=sfGenerateID())+'"><li class="ranking-left fixed">Option 1</li><li class="ranking-right ui-widget-header dragable">Rank 1</li><li class="ranking-break"></li><li class="ranking-left fixed">Option 2</li><li class="ranking-right ui-widget-header dragable">Rank 2</li><li class="ranking-break"></li></ul></li>';break;case"boilerplate":s='<li class="field" name="boilerplate" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Boilerplate</h3><div class="description"></div></li>';break;case"page-break":return sfAddPage(!0),!0;case"ranking-dropdown":s='<li class="field" name="ranking-dropdown" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><ul class="choices" data-id="'+(s=sfGenerateID())+'"><li class="ranking-left">Option 1</li><li class="ranking-right"><select><option value="1">1</option><option value="2">2</option></select></li><li class="ranking-break"></li><li class="ranking-left">Option 2</li><li class="ranking-right"><select><option value="1">1</option><option value="2">2</option></select></li><li class="ranking-break"></li></ul></li>';break;case"likert-scale":s=sfGenerateID();var n=sfGenerateID();s='<li class="field" name="likert-scale" style="" id="'+t+'"><i class="fa fa-times remove" onclick="javascript:sfRemoveQuestion(this);"></i><span class="status"></span><span class="name" title="Identifier"></span><span class="nclass" title="Extra Classes"></span><h3 class="title">Question Text</h3><div class="description"></div><table class="likert-scale"><thead><tr><th></th><th>Scale 1</th><th>Scale 2</th><th>Scale 3</th><th>Scale 4</th></tr></thead><tbody><tr nameid="'+s+'"><td>Option 1</td><td><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label></td></tr><tr nameid="'+n+'"><td>Option 2</td><td><label class="clean-input-wrap"><input type="radio" name="'+n+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+n+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+n+'"><span class="clean-input"></span></label></td><td><label class="clean-input-wrap"><input type="radio" name="'+n+'"><span class="clean-input"></span></label></td></tr></tbody></table></li>'}return e&&sfInsertQuestion(s,t),!0},sfReplaceShortAnswer=function(e){return(e=e.replace(/{x}/g,'<input type="text" class="text" style="width: 200px;" value="">')).replace(/{y}/g,'<textarea class="text" style="width: 400px;height:200px;"></textarea>')},sfEnableOptions=function(){currQuestion?($("#fieldPropertiesDisable").hide(),$("#fieldProperties").show(),$("#SettingsDisable").hide(),$("#Settings").show(),"short-answer"!=currQuestion.attr("name")&&$("#panelRules").show(),$("#panelActions").css("display","block")):sfDisableOptions()},sfDisableOptions=function(){$("#fieldPropertiesDisable").show(),$("#fieldProperties").hide(),$("#SettingsDisable").show(),$("#Settings").hide(),$("#panelRules").hide(),$("#panelActions").css("display","none")},sfSetSelected=function(e,t){for(var s=$("select[name='"+e+"']").find("option"),n=0;n<s.length;n++){var a=s[n];$(a).val()==parseInt(t)?($(a).attr("selected","selected"),$(a).prop("selected",!0)):($(a).removeAttr("selected"),$(a).prop("selected",!1))}return!0},sfSetCheckbox=function(e,t){return t?($("input[name='"+e+"']").attr("checked","checked"),$("input[name='"+e+"']").prop("checked",!0)):t||($("input[name='"+e+"']").attr("checked",""),$("input[name='"+e+"']").prop("checked",!1)),!0},sfSetIscale=function(e){var t=$(currQuestion).attr("id");questionsStack[t].sf_iscale=e},sfSetOptionsFields=function(e){var t=questionsStack[e].sf_qtitle?questionsStack[e].sf_qtitle:"Enter Question Text",s=questionsStack[e].sf_qdescription?questionsStack[e].sf_qdescription:"",n=questionsStack[e].sf_iscale?questionsStack[e].sf_iscale:"",a=void 0!==questionsStack[e].published?questionsStack[e].published:1,i=void 0!==questionsStack[e].sf_compulsory?questionsStack[e].sf_compulsory:0,r=void 0!==questionsStack[e].sf_default_hided?questionsStack[e].sf_default_hided:0,o=void 0!==questionsStack[e].is_final_question?questionsStack[e].is_final_question:0;sfSetSelected("sf_qtype",questionsStack[e].sf_qtype?questionsStack[e].sf_qtype:"section-separator"),$("textarea[name='sf_qtitle']").val(t),$("textarea[name='sf_qdescription']").val(s),sfSetSelected("sf_iscale",n),sfSetCheckbox("published",a),sfSetCheckbox("sf_compulsory",i),sfSetCheckbox("sf_default_hided",r),sfSetCheckbox("is_final_question",o)},sfChangeRightOption=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent(),n=$(s).index(),a=$(e).val();questionsStack[t].answers[n].right=a;var i=$(currQuestion).find(".choices .ranking-right select");return i.length?$(i).each(function(e){e=$(i[e]).find("option").get(n),$(e).val(a),$(e).text(a)}):(e=$(currQuestion).find(".choices li.ranking-right"),e=$(e).get(n),$(e).text(a)),refreshAnswersList(),!0},sfChangeLeftOption=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent();s=$(s).index();return e=$(e).val(),questionsStack[t].answers[s].left=e,t=$(currQuestion).find(".choices .ranking-left"),$(t[s]).text(e),refreshAnswersList(),!0},sfChangeChoice=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent();s=$(s).index();return e=$(e).val(),questionsStack[t].answers[s].title=e,questionsStack[t].choiceStyle?(t=$(currQuestion).find(".choices option").get(s),$(t).text(e)):(t=$(currQuestion).find(".choices li").get(s),$(t).find(".choice-value").text(e)),refreshAnswersList(),changeAnswersInHides(s),!0},sfRemoveScale=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent(),n=$(s).index();return questionsStack[t].answers.scales.splice(n-1,1),questionsStack[t].answers.sid.splice(n-1,1),$(e).parent().parent().fadeOut(300,function(){$(this).remove();var e=$(currQuestion).find(".likert-scale th").get(n);$(e).remove();var t=$(currQuestion).find(".likert-scale tr");$(t).each(function(e){e=$(t[e]).find("td").get(n),$(e).remove()})}),refreshAnswersList(),removeAnswersInHides(n-1),!0},sfRemoveRank=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent(),n=$(s).index();return questionsStack[t].answers.splice(n,1),$(e).parent().parent().fadeOut(300,function(){$(this).remove();var e=$(currQuestion).find(".choices li.ranking-left"),t=$(e[n]).next();$(e[n]).remove(),$(t).remove();var s=$(currQuestion).find(".choices li.ranking-right select");$(s).each(function(e){e=$(s[e]).find("option").get(n),$(e).remove()})}),refreshAnswersList(),removeAnswersInHides(n),!0},sfRemoveRank2=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent(),n=$(s).index();return n--,questionsStack[t].answers.ranks.splice(n,1),questionsStack[t].answers.rid.splice(n,1),$(e).parent().parent().fadeOut(300,function(){$(this).remove();var e=$(currQuestion).find(".choices li.ranking-right select");$(e).each(function(t){t=$(e[t]).find("option").get(n),$(t).remove()})}),refreshAnswersList(),removeAnswersInHides(n),!0},sfRemoveOption=function(e,t){var s=$(currQuestion).attr("id"),n=$(e).parent().parent(),a=$(n).index();return a--,questionsStack[s].answers.options.splice(a,1),questionsStack[s].answers.oid.splice(a,1),$(e).parent().parent().fadeOut(300,function(){if($(this).remove(),"ranking-dropdown"==t){var e=$(currQuestion).find(".choices .ranking-left").get(a),s=$(currQuestion).find(".choices .ranking-right").get(a),n=$(currQuestion).find(".choices .ranking-break").get(a);$(e).remove(),$(s).remove(),$(n).remove()}else"likert-scale"==t&&(e=$(currQuestion).find(".likert-scale tr").get(a+1),$(e).remove())}),refreshAnswersList(),!0},sfRemoveChoice=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent(),n=$(s).index();questionsStack[t].answers.splice(n,1);var a=questionsStack[t].choiceStyle;return $(e).parent().parent().fadeOut(300,function(){$(this).remove();var e=a?$(currQuestion).find(".choices option").get(n):$(currQuestion).find(".choices li").get(n);$(e).remove()}),refreshAnswersList(),removeAnswersInHides(n),!0},sfGetChoicesPanel=function(){return'<div class="panel-group" id="panelChoices"><div class="panel panel-default"><div class="panel-heading" data-toggle="collapse" data-parent="#panelChoices" href="#collapseChoices"><h4>Choices<i class="fa fa-sort-desc" style="float:right;"></i></h4></div><div style="height: auto;" class="panel-collapse collapse in" id="collapseChoices"><div class="panel-body">{PANEL_BODY}</div></div></div></div>'},sfAddQuestionOption=function(e){var t;return""!=e&&($(e).insertAfter("#panelProperties"),$("#choices-list").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,s){t=sfStartIndex(e,s)},stop:function(e,s){sfChangeChoiceOrdering(e,s,t)}}),$("#ranking-list").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,s){t=sfStartIndex(e,s)},stop:function(e,s){sfChangeRankOrdering(e,s,t)}}),$("#panelChoices").find(".option a").unbind("click"),$("#panelChoices").find(".option a").click(function(){sfRemoveChoice(this)}),$("#panelChoices").find(".option input").unbind("keyup"),$("#panelChoices").find(".option input").keyup(function(){sfChangeChoice(this)}),$("#panelChoices").find(".rank-left input.ranking-text").unbind("keyup"),$("#panelChoices").find(".rank-left input.ranking-text").keyup(function(){sfChangeLeftOption(this)}),$("#panelChoices").find(".rank-right input.ranking-text").unbind("keyup"),$("#panelChoices").find(".rank-right input.ranking-text").keyup(function(){sfChangeRightOption(this)}),$("#panelChoices").find(".rank-right a").unbind("click"),$("#panelChoices").find(".rank-right a").click(function(){sfRemoveRank(this)}),bindRankEvents(),bindLikertEvents(),$.fn.selectpicker&&$(".selectpicker").selectpicker()),!0},bindLikertEvents=function(){$("#panelChoices").find("#scale-list .scale .scale-text").unbind("keyup"),$("#panelChoices").find("#scale-list .scale .scale-text").keyup(function(){sfChangeScale(this)}),$("#panelChoices").find("#option-list-likert .options .option-text").unbind("keyup"),$("#panelChoices").find("#option-list-likert .options .option-text").keyup(function(){sfChangeOption(this,"likert-scale")}),$("#panelChoices").find("#scale-list .scale a.scale-remove").unbind("click"),$("#panelChoices").find("#scale-list .scale a.scale-remove").click(function(){sfRemoveScale(this)}),$("#panelChoices").find("#option-list-likert .options a.option-remove").unbind("click"),$("#panelChoices").find("#option-list-likert .options a.option-remove").click(function(){sfRemoveOption(this,"likert-scale")}),$("#scale-list").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,t){startIndex=sfStartIndex(e,t)},stop:function(e,t){sfChangeScaleOrdering(e,t,startIndex)}}),$("#option-list-likert").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,t){startIndex=sfStartIndex(e,t)},stop:function(e,t){sfChangeOptionOrdering(e,t,startIndex,"likert-scale")}})},bindRankEvents=function(){$("#panelChoices").find("#rank-list .rank .rank-text").unbind("keyup"),$("#panelChoices").find("#rank-list .rank .rank-text").keyup(function(){sfChangeRank(this)}),$("#panelChoices").find("#option-list-ranking .options .option-text").unbind("keyup"),$("#panelChoices").find("#option-list-ranking .options .option-text").keyup(function(){sfChangeOption(this,"ranking")}),$("#panelChoices").find("#rank-list .rank a.rank-remove").unbind("click"),$("#panelChoices").find("#rank-list .rank a.rank-remove").click(function(e){sfRemoveRank2(this)}),$("#panelChoices").find("#option-list-ranking .options a.option-remove").unbind("click"),$("#panelChoices").find("#option-list-ranking .options a.option-remove").click(function(){sfRemoveOption(this,"ranking")}),$("#rank-list").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,t){startIndex=sfStartIndex(e,t)},stop:function(e,t){sfChangeRankOrdering2(e,t,startIndex)}}),$("#option-list-ranking").sortable({axis:"y",placeholder:"ui-state-highlight",cursor:"move",start:function(e,t){startIndex=sfStartIndex(e,t)},stop:function(e,t){sfChangeOptionOrdering(e,t,startIndex,"ranking")}})},sfAddRank=function(e){var t=$(currQuestion).attr("id");if("ranking-dropdown"==e){questionsStack[t].answers.ranks.push("New rank"),questionsStack[t].answers.rid.push(""),t='<li><div class="rank"><i class="fa fa-arrows rank-order"></i><input type="text" value=" New rank" class="rank-text"><a href="#" class="remove rank-remove"><i class="fa fa-times"></i></a></div></li>',$("#rank-list").append(t);var s=$(currQuestion).find(".choices .ranking-right select");$(s).each(function(e){$(s[e]).append('<option value="New rank">New rank</option>')}),bindRankEvents(e)}else if("likert-scale"==e){questionsStack[t].answers.scales.push("New scale"),questionsStack[t].answers.sid.push(""),t='<li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" value="New scale" class="scale-text"><a href="#" class="remove scale-remove"><i class="fa fa-times"></i></a></div></li>',$("#scale-list").append(t),(t=$(currQuestion).find(".likert-scale tr:first"))?$(t).append("<th>New scale</th>"):$(".likert-scale").append("<thead><tr><th></th><th>New scale</th></tr></thead><tbody></tbody>");var n=$(currQuestion).find(".likert-scale tr").not("tr:first");n.length&&$(n).each(function(e){var t='<td class="ui-selectee"><label class="clean-input-wrap ui-selectee"><input type="radio" name="'+$(n[e]).attr("nameid")+'" class="ui-selectee"><span class="clean-input ui-selectee"></span></label></td>';$(n[e]).append(t)}),bindLikertEvents(e)}return refreshAnswersList(),!0},sfAddOption=function(e){var t=$(currQuestion).attr("id");if(questionsStack[t].answers.options.push("New option"),questionsStack[t].answers.oid.push(""),"ranking-dropdown"==e){if($("#option-list-ranking").append('<li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" value="New option" class="option-text"><a href="#" class="remove option-remove"><i class="fa fa-times"></i></a></div></li>'),(e=questionsStack[t].answers.ranks).length){var s='<select class="ui-selectee">';for(t=0;t<e.length;t++)s+='<option value="'+e[t]+'">'+e[t]+"</option>";s+="</select>"}s='<li class="ranking-left ui-selectee">New option</li><li class="ranking-right ui-selectee">'+s+'</li><li class="ranking-break ui-selectee"></li>',$(currQuestion).find(".choices").append(s)}else{$("#option-list-likert").append('<li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" value="New option" class="option-text"><a href="#" class="remove option-remove"><i class="fa fa-times"></i></a></div></li>');s=$(currQuestion).find(".likert-scale tbody");var n=sfGenerateID(),a='<tr nameid="'+n+'"><td>New option</td>';(e=$(currQuestion).find(".likert-scale thead th").not("th:first")).length&&$(e).each(function(e){a+='<td><label class="clean-input-wrap ui-selectee"><input type="radio" class="ui-selectee" name="'+n+'"><span class="clean-input ui-selectee"></span></label></td>'}),a+="</tr>",$(s).append(a)}return bindRankEvents(),refreshAnswersList(),!0},sfAddRanking=function(e,t,s){var n='<li class="ui-sortable-handle"><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="'+e+'"></div><div class="rank-right"><input type="text" class="ranking-text" value="'+t+'"><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li>';return $(".text-list").append(n),$("#panelChoices").find(".rank-right a.rank-remove").click(function(){sfRemoveRank(this)}),$("#panelChoices").find(".rank-left input.ranking-text").keyup(function(){sfChangeLeftOption(this)}),$("#panelChoices").find(".rank-right input.ranking-text").keyup(function(){sfChangeRightOption(this)}),n=$(currQuestion).attr("id"),questionsStack[n].answers.push({left:e,right:t,leftid:"",rightid:""}),"ranking"==s&&(n=$(currQuestion).find(".choices li.ranking-right").get(0),null==(n=$(n).html())&&(n="<select></select>"),n='<li class="ranking-left ui-selectee">'+e+'</li><li class="ranking-right ui-selectee">'+n+'</li><li class="ranking-break ui-selectee"></li>',$(currQuestion).find(".choices").append(n),n='<option value="'+t+'">'+t+"</option>",$(currQuestion).find(".choices .ranking-right select").append(n)),"ranking-dragdrop"==s&&(n='<li class="ranking-left fixed ui-selectee">'+e+'</li><li class="ranking-right dragable ui-selectee ui-widget-header">'+t+'</li><li class="ranking-break ui-selectee"></li>',$(currQuestion).find(".choices").append(n),$(".dragable").draggable({containment:$(currQuestion),scroll:!1})),refreshAnswersList(),!0},sfAddChoice=function(e,t,s){e=e||"Choice Text",(void 0===t||t)&&(t='<li class="ui-sortable-handle" style=""><div class="option"><a href="#" class="remove"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" value="'+e+'" class="text"></div></li>',$("#choices-list").append(t),$("#panelChoices").find(".option a").click(function(){sfRemoveChoice(this)}),$("#panelChoices").find(".option input").keyup(function(){sfChangeChoice(this)})),t=$(currQuestion).attr("id"),questionsStack[t].answers.push({title:e,id:""});var n=$(currQuestion).find(".choices").attr("data-id");return s="pick-one"==s?"radio":"checkbox",questionsStack[t].choiceStyle?(e="<option>"+e+"</option>",$(currQuestion).find(".choices").append(e)):(e='<li class="choice ui-selectee"><label class="ui-selectee"><label class="clean-input-wrap ui-selectee"><input type="'+s+'" name="'+n+'" class="ui-selectee"><span class="clean-input ui-selectee"></span></label> <span class="choice-value ui-selectee">'+e+"</span></label></li>",$("#"+t+" .choices .other").length?$(e).insertBefore("#"+t+" .choices .other"):$(currQuestion).find(".choices").append(e)),refreshAnswersList(),!0},sfCollectQuestions=function(e){var t=$(e).attr("name").replace("section_","");if(questionsStack[t].sections=[],(e=$(e).find("option:selected")).length)for(var s=0;s<e.length;s++)questionsStack[t].sections.push($(e[s]).val())},sfSelectOption=function(e){if((e=$(e).parent().find("option")).length)for(var t=0;t<e.length;t++){var s=e[t];$(s).prop("selected")?$(s).attr("selected","selected"):$(s).removeAttr("selected")}},sfGetOptions=function(e){var t=$(currQuestion).attr("name");if(questionsStack[e].exists)switch(t){case"boilerplate":$("#question-type").html("Boilerplate");break;case"short-answer":$("#question-type").html("Short answer");break;case"section-separator":for(s in $("#question-type").html("Section separator"),t='<select multiple="multiple" size="8" name="section_'+e+'" style="width:90%;" onclick="javascript:sfCollectQuestions(this);">',questionsStack)selected=questionsStack[e].sections.length&&sf_inArray(questionsStack[e].sections,s)?'selected="selected"':"","section-separator"!==questionsStack[s].sf_qtype&&(t+='<option value="'+s+'" '+selected+' onclick="javascript:sfSelectOption(this);">'+questionsStack[s].sf_qtitle+"</option>");t+="</select>",n=(n=sfGetChoicesPanel()).replace("{PANEL_BODY}",t);break;case"pick-one":$("#question-type").html("Pick one"),n=sfGetChoicesPanel(),a=sfGetChoices(e,"pick-one"),n=n.replace("{PANEL_BODY}",a);break;case"pick-many":$("#question-type").html("Pick many"),n=sfGetChoicesPanel(),a=sfGetChoices(e,"pick-many"),n=n.replace("{PANEL_BODY}",a);break;case"ranking":$("#question-type").html("Ranking"),n=sfGetChoicesPanel(),a=sfGetRanking(e,"ranking"),n=n.replace("{PANEL_BODY}",a);break;case"ranking-dragdrop":$("#question-type").html("Ranking drag&drop"),n=sfGetChoicesPanel(),a=sfGetRanking(e,"ranking-dragdrop"),n=n.replace("{PANEL_BODY}",a);break;case"ranking-dropdown":case"likert-scale":n=sfGetChoicesPanel(),"ranking-dropdown"==t?($("#question-type").html("Ranking-dropdown"),a=sfGetRanking(e,"ranking-dropdown")):"likert-scale"==t&&($("#question-type").html("Likert scale"),a=sfGetRanking(e,"likert-scale")),n=n.replace("{PANEL_BODY}",a)}else switch(questionsStack[e].exists=1,questionsStack[e].sf_qdescription="",questionsStack[e].sf_iscale="",questionsStack[e].published=1,questionsStack[e].sf_compulsory=0,questionsStack[e].sf_default_hided=0,questionsStack[e].is_final_question=0,t){case"section-separator":$("#question-type").html("Section separator"),questionsStack[e].sf_qtype="section-separator",questionsStack[e].sf_qtitle="Section Heading",questionsStack[e].sections=[];var s;t='<select multiple="multiple" size="8" name="section_'+e+'" style="width:90%;" onclick="javascript:sfCollectQuestions(this);">';for(s in questionsStack)"section-separator"!==questionsStack[s].sf_qtype&&(t+='<option value="'+s+'" onclick="javascript:sfSelectOption(this);">'+questionsStack[s].sf_qtitle+"</option>");t=t+"</select>";var n=(n=sfGetChoicesPanel()).replace("{PANEL_BODY}",t);break;case"pick-one":$("#question-type").html("Pick one"),questionsStack[e].sf_qtype="pick-one",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].choiceStyle=0,questionsStack[e].answers=[],questionsStack[e].answers.push({title:"Choice 1",id:""}),questionsStack[e].answers.push({title:"Choice 2",id:""});var a;n=sfGetChoicesPanel();a='<ul class="text-list" id="choices-list"><li><div class="option"><a class="remove" href="#"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" class="text" tabindex="1" value="Choice 1"></div></li><li><div class="option"><a class="remove" href="#"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" class="text" tabindex="1" value="Choice 2"></div></li></ul>'+sfGetChoicesTools(e,"pick-one"),n=n.replace("{PANEL_BODY}",a);break;case"pick-many":$("#question-type").html("Pick many"),questionsStack[e].sf_qtype="pick-many",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].choiceStyle=0,questionsStack[e].answers=[],questionsStack[e].answers.push({title:"Choice 1",id:""}),questionsStack[e].answers.push({title:"Choice 2",id:""}),n=sfGetChoicesPanel(),a='<ul class="text-list" id="choices-list"><li><div class="option"><a class="remove" href="#"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" class="text" tabindex="1" value="Choice 1"></div></li><li><div class="option"><a class="remove" href="#"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" class="text" tabindex="1" value="Choice 2"></div></li></ul>'+sfGetChoicesTools(e,"pick-many"),n=n.replace("{PANEL_BODY}",a);break;case"short-answer":$("#question-type").html("Short answer"),questionsStack[e].sf_qtype="short-answer",questionsStack[e].sf_qtitle="Every {x} in question text will be replaced by input box. If the number of {x} is more than zero no large text area will be displayed. To place text area with input box in question text use {y} tag.",n="";break;case"ranking":$("#question-type").html("Ranking"),questionsStack[e].sf_qtype="ranking",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].answers=[],questionsStack[e].answers.push({left:"Option 1",right:"Rank 1",leftid:"",rightid:""}),questionsStack[e].answers.push({left:"Option 2",right:"Rank 2",leftid:"",rightid:""}),n=sfGetChoicesPanel(),a='<ul class="text-list" id="ranking-list"><li><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="Option 1" /></div><div class="rank-right"><input type="text" class="ranking-text" value="Rank 1" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="Option 2" /></div><div class="rank-right"><input type="text" class="ranking-text" value="Rank 2" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li></ul>'+sfGetRankingTools(e,"ranking"),n=n.replace("{PANEL_BODY}",a);break;case"ranking-dragdrop":$("#question-type").html("Ranking drag&drop"),questionsStack[e].sf_qtype="ranking-dragdrop",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].answers=[],questionsStack[e].answers.push({left:"Option 1",right:"Rank 1",leftid:"",rightid:""}),questionsStack[e].answers.push({left:"Option 2",right:"Rank 2",leftid:"",rightid:""}),n=sfGetChoicesPanel(),a='<ul class="text-list" id="ranking-list"><li><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="Option 1" /></div><div class="rank-right"><input type="text" class="ranking-text" value="Rank 1" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="Option 2" /></div><div class="rank-right"><input type="text" class="ranking-text" value="Rank 2" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li></ul>'+sfGetRankingTools(e,"ranking-dragdrop"),n=n.replace("{PANEL_BODY}",a);break;case"boilerplate":$("#question-type").html("Boilerplate"),questionsStack[e].sf_qtype="boilerplate",questionsStack[e].sf_qtitle="Boilerplate",n="";break;case"ranking-dropdown":case"likert-scale":"ranking-dropdown"==t?($("#question-type").html("Ranking-dropdown"),questionsStack[e].sf_qtype="ranking-dropdown",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].answers={ranks:["1","2"],options:["Option 1","Option 2"],oid:["",""],rid:["",""]}):"likert-scale"==t&&($("#question-type").html("Likert scale"),questionsStack[e].sf_qtype="likert-scale",questionsStack[e].sf_qtitle="Question Text",questionsStack[e].answers={scales:["Scale 1","Scale 2","Scale 3","Scale 4"],options:["Option 1","Option 2"],oid:["",""],sid:["","","",""]}),n=sfGetChoicesPanel(),"ranking-dropdown"==t?a='<ul class="text-list" id="rank-list"><li class="rank-title">Ranks</li><li><div class="rank"><i class="fa fa-arrows rank-order"></i><input type="text" class="rank-text" value="1" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="rank"><i class="fa fa-arrows rank-order"></i><input type="text" class="rank-text" value="2" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li></ul>'+sfGetRankTools("rank","ranking-dropdown"):"likert-scale"==t&&(a='<ul class="text-list" id="scale-list"><li class="scale-title">Scales</li><li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" class="scale-text" value="Scale 1" /><a class="remove scale-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" class="scale-text" value="Scale 2" /><a class="remove scale-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" class="scale-text" value="Scale 3" /><a class="remove scale-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" class="scale-text" value="Scale 4" /><a class="remove scale-remove" href="#"><i class="fa fa-times"></i></a></div></li></ul>'+sfGetRankTools("rank","likert-scale")),a+='<hr/><ul class="text-list" id="'+("ranking-dropdown"==t?"option-list-ranking":"option-list-likert")+'"><li class="option-title">Answer Options</li><li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" class="option-text" value="Option 1" /><a class="remove option-remove" href="#"><i class="fa fa-times"></i></a></div></li><li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" class="option-text" value="Option 2" /><a class="remove option-remove" href="#"><i class="fa fa-times"></i></a></div></li></ul>',"ranking-dropdown"==t?a+=sfGetRankTools("option","ranking-dropdown"):"likert-scale"==t&&(a+=sfGetRankTools("option","likert-scale")),n=n.replace("{PANEL_BODY}",a)}$("#collapseProperties").hasClass("in")||$("#collapseProperties").addClass("in"),sfCollapseNewQuestion(),sfRemoveChoicesPanel(),sfSetOptionsFields(e),sfEnableOptions(),sfAddQuestionOption(n),$(".tab-pane").removeClass("active"),$(".nav-tabs li").removeClass("active"),$("#questionsButton").addClass("active"),$("#questions").addClass("active"),$(".dragable").draggable({containment:$(currQuestion),scroll:!1}),refreshQuestionsList(),refreshAnswersList(),$("#sf_qtitle").focus()},sfCollapseNewQuestion=function(){$("#basic").removeClass("in")},sfChangeScale=function(e){var t=$(currQuestion).attr("id"),s=$(e).val();return e=$(e).parent().parent().index(),questionsStack[t].answers.scales[e-1]=s,t=$(currQuestion).find(".likert-scale th").get(e),$(t).html(s),refreshAnswersList(),changeAnswersInHides(e-1),!0},sfChangeRank=function(e){var t=$(currQuestion).attr("id"),s=$(e).val(),n=$(e).parent().parent().index();n--,questionsStack[t].answers.ranks[n]=s;var a=$(currQuestion).find(".choices .ranking-right select");return $(a).each(function(e){e=$(a[e]).find("option"),e=$(e).get(n),$(e).val(s),$(e).text(s)}),refreshAnswersList(),changeAnswersInHides(n),!0},sfChangeOption=function(e,t){var s=$(currQuestion).attr("id"),n=$(e).val(),a=$(e).parent().parent().index();return a--,questionsStack[s].answers.options[a]=n,"ranking-dropdown"==t?(s=$(currQuestion).find(".choices .ranking-left"),a=$(s).get(a),$(a).html(n)):"likert-scale"==t&&(a=$(currQuestion).find(".likert-scale tr").get(a+1),$(a).find("td:first").html(n)),refreshAnswersList(),!0},sfGetRankTools=function(e,t){switch(e){case"rank":var s="sfAddRank('"+t+"')";break;case"option":s="sfAddOption('"+t+"')"}return ohtml='<hr/><div class="choices-toolbar option-toolbar"><a class="toolbox-action button button-small" onclick="javascript:'+s+';"><i class="fa fa-plus-circle">&nbsp;Add</i></a></div>'},sfGetRankingTools=function(e,t){switch(t){case"ranking":addFunc="javascript:sfAddRanking('Option Text', 'Rank Text', 'ranking');";break;case"ranking-dragdrop":addFunc="javascript:sfAddRanking('Option Text', 'Rank Text', 'ranking-dragdrop');"}return'<hr/><div class="choices-toolbar ranking-toolbar"><a class="toolbox-action button button-small" onclick="'+addFunc+'"><i class="fa fa-plus-circle">&nbsp;Add</i></a></div>'},sfGetChoicesTools=function(e,t){if(questionsStack[e].answers[0].other_option)var s='checked="checked"',n=questionsStack[e].answers[0].other_option_text;else n=s="";var a="",i="";switch(questionsStack[e].choiceStyle?i="selected='selected'":a="selected='selected'",t){case"pick-one":addFunc="javascript:sfAddChoice('Choice Text', true, 'pick-one');";break;case"pick-many":addFunc="javascript:sfAddChoice('Choice Text', true, 'pick-many');"}return s='<hr/><div class="choices-toolbar"><a class="toolbox-action button button-small" onclick="'+addFunc+'"><i class="fa fa-plus-circle">&nbsp;Add</i></a><a class="toolbox-action button button-small" onclick="javascript:sfDialogBulkList(\''+t+'\');"><i class="fa fa-list">&nbsp;Bulk</i></a></div><br/><ul class="text-list"><li id="sf_other"><input type="checkbox" name="other_option_cb" id="other_option_cb" class="css-checkbox" onclick="javascript:sfToggleOtherOption(\''+t+"');\" "+s+'/><label class="css-label cb0" for="other_option_cb">Others option</label><input type="text" name="other_option" id="other_option" class="input-large" placeholder="Others option" onkeyup="javascript:sfChangeOtherOption();" value="'+n+'"/></li>',"pick-one"==t&&(s+='<li><label for="sf_qstyle" class="use-dropdown">Use drop-down style:</label><select data-style="btn" id="sf_qstyle" name="sf_qstyle" class="form-control" onchange="javascript:sfChangeStyle(this)"><option value="0" '+a+'>No</option><option value="1" '+i+">Yes</option></select></li>"),s+"</ul>"},sfChangeStyle=function(e){var t=$(currQuestion).attr("id");if(0==(e=$(e).val())){questionsStack[t].choiceStyle=0,dataId=$(currQuestion).find(".choices").attr("data-id");var s='<ul class="choices" data-id="'+dataId+'"></ul>';if($(currQuestion).find(".choices").remove(),$(currQuestion).append(s),questionsStack[t].answers.length){s=sfClone(questionsStack[t]),delete questionsStack[t].answers,questionsStack[t].answers=[];for(var n=0;n<s.answers.length;n++)sfAddChoice(s.answers[n].title,!1,"pick-one")}}return 1==e&&(questionsStack[t].choiceStyle=1,sfAddToDropDown()),!0},sfAddToDropDown=function(){dataId=$(currQuestion).find(".choices").attr("data-id"),$(currQuestion).find(".choices").remove();var e=$(currQuestion).attr("id");e=questionsStack[e].answers;if(shtml='<select class="choices" data-id="'+dataId+'">',e.length)for(var t=0;t<e.length;t++)shtml+="<option>"+e[t].title+"</option>";return shtml+="</select>",$(currQuestion).append(shtml),!0},sfGetRanking=function(e,t){if("ranking-dropdown"==t){var s='<ul class="text-list" id="rank-list"><li class="rank-title">Ranks</li>',n=questionsStack[e].answers.ranks;if(n.length)for(var a=0;a<n.length;a++)s+='<li><div class="rank"><i class="fa fa-arrows rank-order"></i><input type="text" class="rank-text" value="'+n[a]+'" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li>';if(s=s+"</ul>"+sfGetRankTools("rank",t),s+='<hr/><ul class="text-list" id="option-list-ranking"><li class="option-title">Answer Options</li>',(n=questionsStack[e].answers.options).length)for(a=0;a<n.length;a++)s+='<li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" class="option-text" value="'+n[a]+'" /><a class="remove option-remove" href="#"><i class="fa fa-times"></i></a></div></li>';s+="</ul>",s+=sfGetRankTools("option",t)}else if("likert-scale"==t){if(s='<ul class="text-list" id="scale-list"><li class="scale-title">Scales</li>',(n=questionsStack[e].answers.scales).length)for(a=0;a<n.length;a++)s+='<li><div class="scale"><i class="fa fa-arrows scale-order"></i><input type="text" class="scale-text" value="'+n[a]+'" /><a class="remove scale-remove" href="#"><i class="fa fa-times"></i></a></div></li>';if(s+="</ul>",s+=sfGetRankTools("rank",t),s+='<hr/><ul class="text-list" id="option-list-likert"><li class="option-title">Answer Options</li>',(n=questionsStack[e].answers.options).length)for(a=0;a<n.length;a++)s+='<li><div class="options"><i class="fa fa-arrows option-order"></i><input type="text" class="option-text" value="'+n[a]+'" /><a class="remove option-remove" href="#"><i class="fa fa-times"></i></a></div></li>';s+="</ul>",s+=sfGetRankTools("option",t)}else{if(s='<ul class="text-list" id="ranking-list">',(n=questionsStack[e].answers).length)for(a=0;a<n.length;a++)s+='<li><div class="rank-left"><i class="fa fa-arrows rank-order"></i><input type="text" class="ranking-text" value="'+n[a].left+'" /></div><div class="rank-right"><input type="text" class="ranking-text" value="'+n[a].right+'" /><a class="remove rank-remove" href="#"><i class="fa fa-times"></i></a></div></li>';s+="</ul>",s+=sfGetRankingTools(e,t)}return s},sfGetChoices=function(e,t){var s='<ul class="text-list" id="choices-list">',n=questionsStack[e].answers;if(n.length)for(var a=0;a<n.length;a++)s+='<li><div class="option"><a class="remove" href="#"><i class="fa fa-times"></i></a><i class="fa fa-arrows"></i><input type="text" class="text" value="'+n[a].title+'"></div></li>';return s+"</ul>"+sfGetChoicesTools(e,t)},sfToggleOtherOption=function(e){var t=$(currQuestion).attr("id"),s=$("#"+t).find("ul.choices").attr("data-id");if($("#other_option_cb").prop("checked")){if($("#other_option").val("Other, please specify..."),"pick-one"==e)var n='<li class="choice other"><label><label class="clean-input-wrap"><input type="radio" name="'+s+'"><span class="clean-input"></span></label> <span class="choice-value">Other, please specify...</span><input type="text" "="" class="text dummy"></label></li>';"pick-many"==e&&(n='<li class="choice other"><label><label class="clean-input-wrap"><input type="checkbox" name="'+s+'"><span class="clean-input"></span></label> <span class="choice-value">Other, please specify...</span><input type="text" "="" class="text dummy"></label></li>'),$("#"+t+" .choices").append(n),questionsStack[t].answers[0].other_option=1,questionsStack[t].answers[0].other_option_text="Other, please specify..."}else $("#"+t).find("li.other").remove(),questionsStack[t].answers[0].other_option=0,questionsStack[t].answers[0].other_option_text="",$("#other_option").val("");return!0},sfChangeOtherOption=function(){var e=$(currQuestion).attr("id"),t=$("#other_option").val();return $(currQuestion).find("ul.choices .other .choice-value").text(t),questionsStack[e].answers[0].other_option_text=t,!0},sfRemoveChoicesPanel=function(){return $("#panelChoices").remove(),!0},sfStartIndex=function(e,t){return $(t.item).index()},sfChangeScaleOrdering=function(e,t,s){var n=$(currQuestion).attr("id"),a=$(t.item).prev().index(),i=$(t.item).next().index();e=$(currQuestion).find(".likert-scale thead th").get(s),t=$(currQuestion).find(".likert-scale thead tr");var r=$(currQuestion).find(".likert-scale tbody tr");if(0<=a){if(s>a){var o=$(t).find("th").get(a);$(e).insertAfter(o)}s<=a&&(o=$(t).find("th").get(a+1),$(e).insertAfter(o))}else t=$(t).find("th").get(i-1),$(e).insertBefore(t);r.length&&$(r).each(function(e){var t=$(r[e]).find("td").get(s);if(0<=a){if(s>a){var n=$(r[e]).find("td").get(a);$(t).insertAfter(n)}s<=a&&(n=$(r[e]).find("td").get(a+1),$(t).insertAfter(n))}else e=$(r[e]).find("td").get(i-1),$(t).insertBefore(e)});var l=$("#scale-list .scale .scale-text");$(l).each(function(e){var t=$(l[e]).val();questionsStack[n].answers.scales[e]=t}),refreshAnswersList()},sfChangeOptionOrdering=function(e,t,s,n){if($(t).hasClass("option-title"))return!1;var a=$(currQuestion).attr("id");if(e=$(t.item).prev().index(),t=$(t.item).next().index(),e--,t--,s--,"ranking-dropdown"==n){var i=$(currQuestion).find(".choices .ranking-left"),r=$(currQuestion).find(".choices .ranking-right"),o=$(currQuestion).find(".choices .ranking-break");n=$(i).get(s);r=$(r).get(s);var l=$(o).get(s);0<=e?(s>e&&(t=$(o).get(e),$(l).insertAfter(t),$(r).insertAfter(t),$(n).insertAfter(t)),s<=e&&(t=$(o).get(e+1),$(l).insertAfter(t),$(r).insertAfter(t),$(n).insertAfter(t))):(s=$(i).get(t-1),$(n).insertBefore(s),$(r).insertBefore(s),$(l).insertBefore(s)),qRank=$("#rank-list .rank .rank-text"),qOption=$("#option-list-ranking .options .option-text"),$(qRank).each(function(e){var t=$(qRank[e]).val();questionsStack[a].answers.ranks[e]=t}),$(qOption).each(function(e){var t=$(qOption[e]).val();questionsStack[a].answers.options[e]=t})}else"likert-scale"==n&&(dTr=$(currQuestion).find(".likert-scale tbody tr").get(s),0<=e?(s>e&&(t=$(currQuestion).find(".likert-scale tbody tr").get(e),$(dTr).insertAfter(t)),s<=e&&(t=$(currQuestion).find(".likert-scale tbody tr").get(e+1),$(dTr).insertAfter(t))):(s=$(currQuestion).find(".likert-scale tbody tr").get(t-1),$(dTr).insertBefore(s)),qOption=$("#option-list-likert .options .option-text"),$(qOption).each(function(e){var t=$(qOption[e]).val();questionsStack[a].answers.options[e]=t}));return refreshAnswersList(),!0},sfChangeRankOrdering2=function(e,t,s){if($(t).hasClass("rank-title"))return!1;var n=$(currQuestion).attr("id"),a=$(currQuestion).find(".choices .ranking-right select"),i=$(t.item).prev().index(),r=$(t.item).next().index();return i--,r--,s--,$(a).each(function(e){var t=$(a[e]).find("option");if(e=$(t).get(s),0<=i){if(s>i){var n=$(t).get(i);$(e).insertAfter(n)}s<=i&&(n=$(t).get(i+1),$(e).insertAfter(n))}else t=$(t).get(r-1),$(e).insertBefore(t)}),ranks=$("#rank-list div.rank .rank-text"),$(ranks).each(function(e){var t=$(ranks[e]).val();questionsStack[n].answers.ranks[e]=t}),refreshAnswersList(),!0},sfChangeRankOrdering=function(e,t,s){var n=$(currQuestion).attr("id"),a=$(currQuestion).find(".choices li.ranking-left"),i=$(currQuestion).find(".choices li.ranking-right"),r=$(currQuestion).find(".choices li.ranking-break");e=$(a).get(s);i=$(i).get(s);var o=$(r).get(s),l=$(t.item).prev().index();t=$(t.item).next().index(),0<=l?(s>l&&(t=$(r).get(l),$(o).insertAfter(t),$(i).insertAfter(t),$(e).insertAfter(t)),s<=l&&(t=$(r).get(l+1),$(o).insertAfter(t),$(i).insertAfter(t),$(e).insertAfter(t))):(s=$(a).get(t-1),$(e).insertBefore(s),$(i).insertBefore(s),$(o).insertBefore(s)),qLeft=$("#ranking-list li div.rank-left .ranking-text"),qRight=$("#ranking-list li div.rank-right .ranking-text"),$(qLeft).each(function(e){var t=$(qLeft[e]).val(),s=$(qRight[e]).val();questionsStack[n].answers[e].left=t,questionsStack[n].answers[e].right=s}),refreshAnswersList()},sfChangeChoiceOrdering=function(e,t,s){var n=$(currQuestion).attr("id"),a=questionsStack[n].choiceStyle,i=a?$(currQuestion).find(".choices option"):$(currQuestion).find(".choices li");e=$(i).get(s);var r=$(t.item).prev().index();return t=$(t.item).next().index(),0<=r?(s>r&&(t=$(i).get(r),$(e).insertAfter(t)),s<=r&&(t=$(i).get(r+1),$(e).insertAfter(t))):(s=$(i).get(t-1),$(e).insertBefore(s)),i=a?$(currQuestion).find(".choices option"):$(currQuestion).find(".choices li"),$(i).each(function(e){var t=a?$(i[e]).text():$(i[e]).find(".choice-value").text();questionsStack[n].answers[e].title=t}),refreshAnswersList(),!0},sfInsertQuestion=function(e,t){return $(".placeholder").remove(),$("#survey-questions"+currPage).append(e),sfClearActives(),$("#"+t).addClass("active"),$("#"+t+" i.remove").css("opacity","1"),$("#survey-questions"+currPage).selectable(),$("#"+t).click(function(){return sfClearActives(),$(this).addClass("active"),$(this).find("i.remove").css("opacity","1"),currQuestion=$(this),sfGetOptions(t),!0}),currQuestion=$("#"+t),questionsStack[t]={},questionsStack[t].exists=0,questionsStack[t].page=currPage,questionsStack[t].hides=[],questionsStack[t].rules=[],questionsStack[t].questOrdering="",sfGetOptions(t),questOrdering++,sf_SortQuestions(),!0},sfClearActives=function(){$("ol.page li").removeClass("active"),$("ol.page i.remove").css("opacity","0.2")},refreshQuestionsList=function(){var e=$(currQuestion).attr("id");if(questionsStack){var t=$("#sf_quest_list2");t.html("");var s=$("#sf_quest_list3");s.html("");var n=$("#sf_quest_list");n.html("");var a,i='<option value="0">- Select question -</option>';for(a in questionsStack)if(a!=e&&"short-answer"!=questionsStack[a].sf_qtype&&"boilerplate"!=questionsStack[a].sf_qtype&&"section-separator"!=questionsStack[a].sf_qtype&&"page-break"!=questionsStack[a].sf_qtype){var r;i=i+'<option value="'+a+'">'+(r=30<(r=strip_tags(r=questionsStack[a].sf_qtitle)).length?r.substr(0,30)+"...":r)+"</option>"}t.html(i),s.html(i),n.html(i)}};function strip_tags(e){return e.replace(/<\/?[^>]+>/gi,"")}var refreshAnswersList=function(){if(currQuestion){var e=!1,t=$(currQuestion).attr("id"),s='<option value="0">- Select answer -</option>',n=$("#sf_field_list"),a=$("#sf_option_list");if(n.html(""),a.html(""),t)switch(questionsStack[t].sf_qtype){case"pick-one":case"pick-many":if(questionsStack[t].answers.length)for(var i=0;i<questionsStack[t].answers.length;i++)s=s+'<option value="'+(i+1)+'">'+(r=30<questionsStack[t].answers[i].title.length?questionsStack[t].answers[i].title.substr(0,30)+"...":questionsStack[t].answers[i].title)+"</option>";break;case"ranking":case"ranking-dragdrop":if(e=!0,option='<option value="0">- Select option -</option>',questionsStack[t].answers.length)for(i=0;i<questionsStack[t].answers.length;i++){var r=30<questionsStack[t].answers[i].right.length?questionsStack[t].answers[i].right.substr(0,30)+"...":questionsStack[t].answers[i].right,o=30<questionsStack[t].answers[i].left.length?questionsStack[t].answers[i].left.substr(0,30)+"...":questionsStack[t].answers[i].left;s=s+'<option value="'+(i+1)+'">'+r+"</option>";option+='<option value="'+(i+1)+'">'+o+"</option>"}break;case"ranking-dropdown":if(e=!0,option='<option value="0">- Select option -</option>',questionsStack[t].answers.ranks.length)for(i=0;i<questionsStack[t].answers.ranks.length;i++)s+='<option value="'+(i+1)+'">'+(r=30<questionsStack[t].answers.ranks[i].length?questionsStack[t].answers.ranks[i].substr(0,30)+"...":questionsStack[t].answers.ranks[i])+"</option>";if(questionsStack[t].answers.options.length)for(i=0;i<questionsStack[t].answers.options.length;i++)o=30<questionsStack[t].answers.options[i].length?questionsStack[t].answers.options[i].substr(0,30)+"...":questionsStack[t].answers.options[i],option+='<option value="'+(i+1)+'">'+o+"</option>";break;case"likert-scale":if(e=!0,option='<option value="0">- Select option -</option>',questionsStack[t].answers.scales.length)for(i=0;i<questionsStack[t].answers.scales.length;i++)s+='<option value="'+(i+1)+'">'+(r=30<questionsStack[t].answers.scales[i].length?questionsStack[t].answers.scales[i].substr(0,30)+"...":questionsStack[t].answers.scales[i])+"</option>";if(questionsStack[t].answers.options.length)for(i=0;i<questionsStack[t].answers.options.length;i++)o=30<questionsStack[t].answers.options[i].length?questionsStack[t].answers.options[i].substr(0,30)+"...":questionsStack[t].answers.options[i],option+='<option value="'+(i+1)+'">'+o+"</option>"}n.html(s),e?($(".rule_option").show(),a.html(option)):($(".rule_option").hide(),a.html("")),getHideQuestion(),getRulesQuestion(),sfGetAnswers($("#sf_quest_list3"))}return!0},sfGetAnswers=function(e){$("#hide_for_option").next().remove(),$("#hide_for_option").remove();var t=$("#f_scale_data");if(t.html(""),"0"!=(e=$(e).val())){var s='<option value="0">- Select answer -</option>',n=questionsStack[e].sf_qtype;switch(n){case"pick-one":case"pick-many":if(questionsStack[e].answers.length)for(var a=0;a<questionsStack[e].answers.length;a++)s+='<option value="'+(a+1)+'">'+(n=30<questionsStack[e].answers[a].title.length?questionsStack[e].answers[a].title.substr(0,30)+"...":questionsStack[e].answers[a].title)+"</option>";break;case"ranking":case"ranking-dragdrop":var i='<div class="control-group form-inline" id="hide_for_option"><label class="control-label">And for option:</label><div class="controls"><select id="sf_field_data_m" name="sf_field_data_m" style="width:250px;"></select></div></div><div style="clear:both"><br/></div>',r='<option value="0">- Select option -</option>';if(questionsStack[e].answers.length)for(a=0;a<questionsStack[e].answers.length;a++){var o=30<questionsStack[e].answers[a].left.length?questionsStack[e].answers[a].left.substr(0,30)+"...":questionsStack[e].answers[a].left;r=r+'<option value="'+(a+1)+'">'+o+"</option>"}if($(i).insertAfter($("#hide_for_question")),$("#sf_field_data_m").html(r),questionsStack[e].answers.length)for(a=0;a<questionsStack[e].answers.length;a++)s+='<option value="'+(a+1)+'">'+(n=30<questionsStack[e].answers[a].right.length?questionsStack[e].answers[a].right.substr(0,30)+"...":questionsStack[e].answers[a].right)+"</option>";break;case"ranking-dropdown":case"likert-scale":if(i='<div class="control-group form-inline" id="hide_for_option"><label class="control-label">And for option:</label><div class="controls"><select id="sf_field_data_m" name="sf_field_data_m" style="width:250px;"></select></div></div><div style="clear:both"><br/></div>',r='<option value="0">- Select option -</option>',questionsStack[e].answers.options.length)for(a=0;a<questionsStack[e].answers.options.length;a++)r+='<option value="'+(a+1)+'">'+(o=30<questionsStack[e].answers.options[a].length?questionsStack[e].answers.options[a].substr(0,30)+"...":questionsStack[e].answers.options[a])+"</option>";if($(i).insertAfter($("#hide_for_question")),$("#sf_field_data_m").html(r),"ranking-dropdown"==n){if(questionsStack[e].answers.ranks.length)for(a=0;a<questionsStack[e].answers.ranks.length;a++)s+='<option value="'+(a+1)+'">'+(n=30<questionsStack[e].answers.ranks[a].length?questionsStack[e].answers.ranks[a].substr(0,30)+"...":questionsStack[e].answers.ranks[a])+"</option>"}else if("likert-scale"==n&&questionsStack[e].answers.scales.length)for(a=0;a<questionsStack[e].answers.scales.length;a++)s+='<option value="'+(a+1)+'">'+(n=30<questionsStack[e].answers.scales[a].length?questionsStack[e].answers.scales[a].substr(0,30)+"...":questionsStack[e].answers.scales[a])+"</option>"}t.html(s)}return!0},sfAddHideQuestion=function(){var e=$("#show_quest tbody");e||(e='<tbody><tr id="title"><th colspan="4" class="title">Hide this question if:</th></tr></tbody>',$("#show_quest").append(e));var t=$(currQuestion).attr("id"),s=$("#sf_quest_list3").val(),n=$("#sf_field_data_m").val(),a=$("#f_scale_data").val();if("0"==s||"0"==a)return alert("Select question and answer!"),!1;var i=questionsStack[t].sf_qtype;if(("ranking-dragdrop"==i||"ranking"==i||"ranking-dropdown"==i||"likert-scale"==i)&&"0"==n)return alert("Select option please!"),!1;var r='<tr><td class="hide_'+t+'">'+(r=$("#sf_quest_list3 option:selected").text())+"</td><td>"+$("#sf_field_data_m option:selected").text()+'</td><td class="ans_'+t+"_"+(a-1)+'">'+$("#f_scale_data option:selected").text()+'</td><td><a class="remove hide-remove" href="#" onclick="removeHide(this);"><i class="fa fa-times"></i></a></td></tr>';return $(e).append(r),questionsStack[t].hides.push({qtype:i,question:s,option:n,answer:a}),!0},getHideQuestion=function(){if(currQuestion){var e=$(currQuestion).attr("id");$("#show_quest tbody tr").not("#title").html("");var t=$("#show_quest tbody"),s=questionsStack[e].hides,n='<tr id="title"><th colspan="4" class="title">Hide this question if:</th></tr>';if(currQuestion&&s.length){for(var a=0;a<s.length;a++)if(questionsStack[s[a].question]){var i=30<=(i=questionsStack[s[a].question].sf_qtitle).length?i.substr(0,30)+"...":i;switch(questionsStack[s[a].question].sf_qtype){case"pick-one":case"pick-many":var r=s[a].answer-1;scale_data=questionsStack[s[a].question].answers[r].title,n=n+'<tr><td class="hide_'+s[a].question+'">'+i+'</td><td>&nbsp;</td><td class="answ_'+s[a].question+"_"+r+'">'+scale_data+'</td><td><a class="remove hide-remove" href="#" onclick="removeHide(this);"><i class="fa fa-times"></i></a></td></tr>';break;case"ranking":case"ranking-dragdrop":r=s[a].answer-1,n=n+'<tr><td class="hide_'+s[a].question+'">'+i+"</td><td>"+questionsStack[s[a].question].answers[r].left+'</td><td class="answ_'+s[a].question+"_"+r+'">'+questionsStack[s[a].question].answers[r].right+'</td><td><a class="remove hide-remove" href="#" onclick="removeHide(this);"><i class="fa fa-times"></i></a></td></tr>';break;case"ranking-dropdown":r=s[a].answer-1;var o=questionsStack[s[a].question].answers.options[r];n=n+'<tr><td class="hide_'+s[a].question+'">'+i+"</td><td>"+o+'</td><td class="answ_'+s[a].question+"_"+r+'">'+questionsStack[s[a].question].answers.ranks[r]+'</td><td><a class="remove hide-remove" href="#" onclick="removeHide(this);"><i class="fa fa-times"></i></a></td></tr>';break;case"likert-scale":r=s[a].answer-1;var l=questionsStack[s[a].question].answers.scales[r];o=questionsStack[s[a].question].answers.options[r],n=n+'<tr><td class="hide_'+s[a].question+'">'+i+"</td><td>"+o+'</td><td class="answ_'+s[a].question+"_"+r+'">'+l+'</td><td><a class="remove hide-remove" href="#" onclick="removeHide(this);"><i class="fa fa-times"></i></a></td></tr>'}}else questionsStack[e].hides.splice(a,1);t.html(n)}}return!0},changeQuestionInHides=function(){var e=$(currQuestion).attr("id"),t=questionsStack[e].sf_qtitle;$(".hide_"+e).text(t),$(".rule_"+e).text(t)},changeAnswersInHides=function(e){var t=$(currQuestion).attr("id");switch(questionsStack[t].sf_qtype){case"pick-one":case"pick-many":var s=questionsStack[t].answers[e].title;break;case"ranking":case"ranking-dragdrop":s=questionsStack[t].answers[e].right;break;case"ranking-dropdown":s=questionsStack[t].answers.ranks[e];break;case"likert-scale":s=questionsStack[t].answers.scales[e]}$(".answ_"+t+"_"+e).text(s),$(".rule_answ_"+t+"_"+e).text(s)},removeAnswersInHides=function(e){var t=$(currQuestion).attr("id");$(".answ_"+t+"_"+e).parent().remove()},removeHide=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent();e=$(s).index(),questionsStack[t].hides.splice(e-1,1),$(s).fadeOut(300,function(){$(s).remove()})},sfAddQuestionRule=function(){var e=$("#qfld_tbl_rule tbody"),t=$(currQuestion).attr("id");if("short-answer"==(s=questionsStack[t].sf_qtype)||"boilerplate"==s)return!0;var s=$("#sf_field_list").val(),n=$("#sf_quest_list").val(),a=$("#new_priority").val(),i=$("#sf_option_list").val();if("0"==s)return alert("Select answer please!"),!1;if("0"==n)return alert("Select question please!"),!1;console.log("test"),questionsStack[t].rules.push({question:n,answer:s,option:i,priority:a});var r=$("#sf_field_list option:selected").text(),o=$("#sf_quest_list option:selected").text(),l=$("#sf_option_list option:selected").text();t="<tr><td>&nbsp;</td>"+(i?'<td class="rule_option_'+t+"_"+(i-1)+'">'+l+"</td>":"")+'<td class="rule_answ_'+t+"_"+(s-1)+'">'+r+'</td><td class="rule_'+n+'">'+o+"</td><td>"+a+'</td><td><a class="remove hide-remove" href="#" onclick="removeRule(this);"><i class="fa fa-times"></i></a></td></tr>';$(e).append(t),$("#sf_option_list").val(""),$("#sf_field_list").val(""),$("#sf_quest_list").val(""),$("#new_priority").val("")},getRulesQuestion=function(){var e=!1,t=$(currQuestion).attr("id");$("#qfld_tbl_rule tbody tr").not("tr:first").html("");var s=$("#qfld_tbl_rule tbody"),n=questionsStack[t].rules,a='<tr><th align="center" width="2%">#</th><th width="25%" class="title rule_option" style="display:none;">Option</th><th width="25%" class="title">Answer</th><th width="25%" class="title">Question</th><th width="10%" class="title">priority </th><th width="auto"></th></tr>';if(currQuestion&&n.length){for(var i=0;i<n.length;i++)if(questionsStack[n[i].question]){var r=30<=(r=questionsStack[n[i].question].sf_qtitle).length?r.substr(0,30)+"...":r,o=n[i].priority,l=questionsStack[t].sf_qtype,c=n[i].answer-1,u=n[i].option?n[i].option-1:"-1";if(questionsStack[t].answers[c]){switch(l){case"pick-one":case"pick-many":f=questionsStack[t].answers[c].title;break;case"ranking":case"ranking-dragdrop":e=!0;var f=questionsStack[t].answers[c].right,p=questionsStack[t].answers[u].left;break;case"ranking-dropdown":e=!0,f=questionsStack[t].answers.ranks[c],p=questionsStack[t].answers.options[u];break;case"likert-scale":e=!0,f=questionsStack[t].answers.scales[c],p=questionsStack[t].answers.options[u]}a=a+"<tr><td>&nbsp;</td>"+(e?'<td class="rule_option_'+n[i].question+"_"+u+'">'+p+"</td>":"")+'<td class="rule_answ_'+n[i].question+"_"+c+'">'+f+'</td><td class="rule_'+n[i].question+'">'+r+"</td><td>"+o+'</td><td><a class="remove hide-remove" href="#" onclick="removeRule(this);"><i class="fa fa-times"></i></a></td></tr>'}}s.html(a),e&&$(".rule_option").show()}},removeRule=function(e){var t=$(currQuestion).attr("id"),s=$(e).parent().parent();e=$(s).index(),questionsStack[t].rules.splice(e-1,1),$(s).fadeOut(300,function(){$(s).remove()})},sfSaveSurvey=function(a){$(".viewport").css("opacity",.4);var b=document.getElementById("surveyForm"),b="undefined"==typeof FormData?new FormDataCompatibility(b):new FormData(b),c=new XMLHttpRequest;if(c.open("POST","index.php?option=com_surveyforce&task=survey.saveSurvey&tmpl=component&"+$("#token input").serialize()),c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){if(js=c.responseText,"no login"==js)return parent.location.reload(),window.close(),!1;var a=$("#survey_id").val()?$("#survey_id").val():0,data={json:JSON.stringify(questionsStack)};data[encodeURIComponent($("#token input").attr("name"))]=1,$.ajax({url:"index.php?option=com_surveyforce&task=survey.saveQuestions&tmpl=component&surv_id="+a,method:"POST",data:data,dataType:"json",success:function(a){eval(js),sfParseJSON(a),$(".viewport").css("opacity",1)}})}},"undefined"==typeof FormData?(b.setContentTypeHeader(c),c.send(b.buildBody())):c.send(b),!firstSave||a){if(a=6e4*parseInt($("#autosave").val()),6e4>a)return;"undefined"!=typeof timer&&clearInterval(timer),timer=setInterval("sfSaveSurvey(false)",a),firstSave=!0}return!1},sfParseJSON=function(e){if(e){for(var t in e.questions)questionsStack[t].id=parseInt(e.questions[t]);for(t in e.answers){var s=questionsStack[t].sf_qtype;switch(s){case"pick-one":case"pick-many":if(e.answers[t].length)for(var n=e.answers[t].length,a=0;a<n;a++)questionsStack[t].answers[a].id=parseInt(e.answers[t][a]);break;case"ranking":case"ranking-dragdrop":if(e.answers[t].leftid.length)for(n=e.answers[t].length,a=0;a<n;a++)questionsStack[t].answers[a].leftid=parseInt(e.answers[t].leftid[a]),questionsStack[t].answers[a].rightid=parseInt(e.answers[t].rightid[a]);break;case"ranking-dropdown":case"likert-scale":if(e.answers[t].oid.length)for(questionsStack[t].answers.oid=[],n=e.answers[t].oid.length,a=0;a<n;a++)questionsStack[t].answers.oid.push(parseInt(e.answers[t].oid[a]));if(s="ranking-dropdown"==s?"rid":"sid",e.answers[t][s].length)for(questionsStack[t].answers[s]=[],n=e.answers[t][s].length,a=0;a<n;a++)questionsStack[t].answers[s].push(parseInt(e.answers[t][s][a]))}}}};window.FormDataCompatibility=function(){function e(e){if(this.fields={},this.boundary=this.generateBoundary(),this.contentType="multipart/form-data; boundary="+this.boundary,this.CRLF="\r\n",void 0!==e)for(var t=0;t<e.elements.length;t++){var s=e.elements[t],n=null!==s.name&&""!==s.name?s.name:this.getElementNameByIndex(t);this.append(n,s)}}return e.prototype.getElementNameByIndex=function(e){return"___form_element__"+e},e.prototype.append=function(e,t){return this.fields[e]=t},e.prototype.setContentTypeHeader=function(e){return e.setRequestHeader("Content-Type",this.contentType)},e.prototype.getContentType=function(){return this.contentType},e.prototype.generateBoundary=function(){return"AJAX--------------"+(new Date).getTime()},e.prototype.buildBody=function(){var e,t,s,n;for(e in t=[],n=this.fields)s=n[e],t.push(this.buildPart(e,s));return e="--"+this.boundary+this.CRLF,(e+=t.join("--"+this.boundary+this.CRLF))+"--"+this.boundary+"--"+this.CRLF},e.prototype.buildPart=function(e,t){var s;return"string"==typeof t?(s='Content-Disposition: form-data; name="'+e+'"'+this.CRLF,s+="Content-Type: text/plain; charset=utf-8"+this.CRLF+this.CRLF,s+=unescape(encodeURIComponent(t))+this.CRLF):typeof t==typeof File?(s='Content-Disposition: form-data; name="'+e+'"; filename="'+t.fileName+'"'+this.CRLF,s+="Content-Type: "+t.type+this.CRLF+this.CRLF,s+=t.getAsBinary()+this.CRLF):typeof t==typeof HTMLInputElement&&"file"!=t.type&&(s='Content-Disposition: form-data; name="'+e+'"'+this.CRLF,s+="Content-Type: text/plain; charset=utf-8"+this.CRLF+this.CRLF,s+=unescape(encodeURIComponent(t.value))+this.CRLF),s},e}();